{% extends 'base.html.twig' %}

{% block title %}{{site.name}} | Accueil{% endblock %}

{% block stylesheets %}
 
<!-- BEGIN PAGE LEVEL PLUGINS/CUSTOM STYLES -->
<link href="/css/scrollspyNav.css" rel="stylesheet" type="text/css">
<link href="/plugins/animate/animate.css" rel="stylesheet" type="text/css">
<script src="/plugins/sweetalerts/promise-polyfill.js"></script>
<link href="/plugins/sweetalerts/sweetalert2.min.css" rel="stylesheet" type="text/css">
<link href="/plugins/sweetalerts/sweetalert.css" rel="stylesheet" type="text/css">
<link href="/css/components/custom-sweetalert.css" rel="stylesheet" type="text/css">
<link href="/css/components/tabs-accordian/custom-tabs.css" rel="stylesheet" type="text/css">
<link href="/plugins/apex/apexcharts.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="/css/widgets/modules-widgets.css">  
<link rel="stylesheet" type="text/css" href="/plugins/table/datatable/datatables.css">
<link rel="stylesheet" type="text/css" href="/plugins/table/datatable/dt-global_style.css">
<link href="/plugins/daterangepicker/daterangepicker.css" rel="stylesheet" />
<link href="/css/components/custom-modal.css" rel="stylesheet" type="text/css" />
<!-- Sweet Alert -->
<link href="/plugins/sweet-alert2/sweetalert2.min.css" rel="stylesheet" type="text/css">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/css/bootstrap-datetimepicker.min.css">

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
   integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
   crossorigin=""/>

{# <style>
    .gauge {
        width: 100%;
        height: 100%;
    }
    .size-2 {
        width: 100px;
        height: 150px;
        /*width: 90px;
        height: 120px;*/
        margin: 30px auto 0 auto;
        text-align: center;
        /*border: 1px solid #e9ecef;*/
        padding: 5px;
    }

    #canvas {
        /*margin-left: 0px;
        margin-right: 0px;
        background: #888ea8;*/
        
        /*border: thin solid #aaaaaa;*/
    }
</style>   #}
{% endblock %}

{% block body %}
    <div class="border-top-tab">
        <div class="row widget-statistic layout-top-spacing">

            <div class="col-xl-9 col-lg-9 col-md-9 col-sm-9 col-12 layout-spacing" >
                <div class="row mt-3"><small class="text-left h6">Date de dernière Mise à jour : <span id="last_update">{{gensetData['last_update']}}</span></small></div>
                <div style="position:relative;">
                    <div class="row" >
                        <div class="col">
                            <div class="row layout-top-spacing ">
                            
                                <div class="widget widget-one_hybrid widget-grid-site" style="z-index: 2;">
                                    <div class="widget-heading">
                                        <div class="w-icon">
                                            <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M8.28,5.45L6.5,4.55L7.76,2H16.23L17.5,4.55L15.72,5.44L15,4H9L8.28,5.45M18.62,8H14.09L13.3,5H10.7L9.91,8H5.38L4.1,10.55L5.89,11.44L6.62,10H17.38L18.1,11.45L19.89,10.56L18.62,8M17.77,22H15.7L15.46,21.1L12,15.9L8.53,21.1L8.3,22H6.23L9.12,11H11.19L10.83,12.35L12,14.1L13.16,12.35L12.81,11H14.88L17.77,22M11.4,15L10.5,13.65L9.32,18.13L11.4,15M14.68,18.12L13.5,13.64L12.6,15L14.68,18.12Z" /></svg>
                                        </div>
                                        <div class="source-name">GRID</div>
                                        <p class="w-value text-center"><span id="grid-kW">{% if gensetData['CGCR']['CR'] %}{{gensetData['Power']}}{% else %}0.0{% endif %}</span> kW  
                                        {# <h5 class="">Consommation du mois en cours</h5> #}
                                    </div>
                                    <div class="widget-content">    
                                        <div class="w-chart">
                                            <div id="w-load-chart-grid"></div>
                                        </div>

                                        <div class="row ml-2 mt-2" style="font-size:12px">
                                            <div class="col">Fourniture</div>
                                            <div class="col"><span id="w-grid-fourniture">{{gridData['totalKWh']}}</span> kWh</div>
                                        </div>
                                        <div class="row ml-2" style="font-size:12px">
                                            <div class="col">Contribution</div>
                                            <div class="col"><span id="w-grid-contrib">{{gridData['contrib']}}</span> %</div>
                                        </div>
                                        <div class="row ml-2" style="font-size:12px">
                                            <div class="col">FP</div>
                                            <div class="col"><span id="w-grid-fp">{{gridData['FP']}}</span></div>
                                        </div>
                                        <div class="row ml-2 mb-2" style="font-size:12px">
                                            <div class="col">Pmax</div>
                                            <div class="col"><span id="w-grid-pmax">{{gridData['Pmax']}}</span> kW</div>
                                        </div>
                                    </div>
                                </div>
                                
                            </div>
                            
                            <div class="row layout-top-spacing">
                                
                                <div class="widget widget-one_hybrid widget-genset-site" style="z-index: 2;">
                                    <div class="widget-heading">
                                        <div class="w-icon source-name">
                                            {# <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M8,10H16V18H11L9,16H7V11M7,4V6H10V8H7L5,10V13H3V10H1V18H3V15H5V18H8L10,20H18V16H20V19H23V9H20V12H18V8H12V6H15V4H7Z" /></svg> #}
                                            <?xml version="1.0" encoding="UTF-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M8,10H16V18H11L9,16H7V11M7,4V6H10V8H7L5,10V13H3V10H1V18H3V15H5V18H8L10,20H18V16H20V19H23V9H20V12H18V8H12V6H15V4H7Z" /></svg>
                                        </div>
                                        <div class="source-name"><a href="{{ path('genset_home', {'slug':site.slug,'id':gensetId}) }}" style="color:#e26b1b">Genset</a></div>
                                        <p class="w-value text-center">{% if hasgensetMod %}<span id="genset-kW">{% if gensetData['CGCR']['CG'] %}{{gensetData['Power']}}{% else %}0.0{% endif %}</span> kW{% else %} - {% endif %}
                                        
                                    </div>
                                    <div class="widget-content">    
                                        <div class="w-chart">
                                            <div id="w-load-chart-genset"></div>
                                        </div>

                                        <div class="row ml-2 mt-2" style="font-size:12px">
                                            <div class="col">Fourniture</div>
                                            <div class="col">{% if hasgensetMod %}<span id="w-genset-fourniture">{{gensetData['currentTEP']}}</span> kWh{% else %}-{% endif %}</div>
                                        </div>
                                        <div class="row ml-2" style="font-size:12px">
                                            <div class="col">Contribution</div>
                                            <div class="col">{% if hasgensetMod %}<span id="w-genset-contrib">{{contriGensetKWh}}</span> %{% else %}-{% endif %}</div>
                                        </div>
                                        <div class="row ml-2" style="font-size:12px">
                                            <div class="col">Conso Fuel : </div>
                                            <div class="col">{% if hasgensetMod %}<span id="w-genset-conso-fuel">{{gensetData['currentConsoFuel']}}</span> L{% else %}-{% endif %}</div>
                                        </div>
                                        <div class="row ml-2 mb-2" style="font-size:12px">
                                            <div class="col">Charge Max</div>
                                            <div class="col">{% if hasgensetMod %}<span id="w-genset-load-max">{{gensetData['loadMax']}}</span> %{% else %}-{% endif %}</div>
                                        </div>
                                    </div>
                                </div>
                                
                            </div>
                        </div>

                        <div class="col mb-5">
                            <div class="widget widget-one_hybrid widget-load-site" style="z-index: 2;">
                                <div class="widget-heading">
                                    <div class="w-icon source-name">
                                        <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="plug" class="svg-inline--fa fa-plug fa-w-12" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M320,32a32,32,0,0,0-64,0v96h64Zm48,128H16A16,16,0,0,0,0,176v32a16,16,0,0,0,16,16H32v32A160.07,160.07,0,0,0,160,412.8V512h64V412.8A160.07,160.07,0,0,0,352,256V224h16a16,16,0,0,0,16-16V176A16,16,0,0,0,368,160ZM128,32a32,32,0,0,0-64,0v96h64Z"></path></svg>
                                    </div>
                                    <div class="source-name">Charge</div>
                                    <p class="w-value text-center"><span id="load-kW">{{gensetData['Power']}}</span> kW
                                </div>
                                <div class="widget-content">    
                                    <div class="w-chart">
                                        <div id="w-load-chart"></div>
                                    </div>

                                    <div class="row ml-2 mt-2" style="font-size:12px">
                                        <div class="col">Consommation</div>
                                        <div class="col"><span id="w-load-conso">{{loadSiteData['totalKWh']}}</span> kWh</div>
                                    </div>
                                    <div class="row ml-2" style="font-size:12px">
                                        <div class="col">FP</div>
                                        <div class="col"><span id="w-load-fp">{{loadSiteData['FP']}}</span></div>
                                    </div>
                                    <div class="row ml-2 mb-2" style="font-size:12px">
                                        <div class="col">Pmax</div>
                                        <div class="col"><span id="w-load-pmax">{{loadSiteData['Pmax']}}</span> kW</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col">
                            <div class="row layout-top-spacing ">
                            
                                <div class="widget widget-one_hybrid widget-solar-site" style="z-index: 2;">
                                    <div class="widget-heading">
                                        <div class="w-icon source-name">
                                            <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="solar-panel" class="svg-inline--fa fa-solar-panel fa-w-20" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M431.98 448.01l-47.97.05V416h-128v32.21l-47.98.05c-8.82.01-15.97 7.16-15.98 15.99l-.05 31.73c-.01 8.85 7.17 16.03 16.02 16.02l223.96-.26c8.82-.01 15.97-7.16 15.98-15.98l.04-31.73c.01-8.85-7.17-16.03-16.02-16.02zM585.2 26.74C582.58 11.31 568.99 0 553.06 0H86.93C71 0 57.41 11.31 54.79 26.74-3.32 369.16.04 348.08.03 352c-.03 17.32 14.29 32 32.6 32h574.74c18.23 0 32.51-14.56 32.59-31.79.02-4.08 3.35 16.95-54.76-325.47zM259.83 64h120.33l9.77 96H250.06l9.77-96zm-75.17 256H71.09L90.1 208h105.97l-11.41 112zm16.29-160H98.24l16.29-96h96.19l-9.77 96zm32.82 160l11.4-112h149.65l11.4 112H233.77zm195.5-256h96.19l16.29 96H439.04l-9.77-96zm26.06 256l-11.4-112H549.9l19.01 112H455.33z"></path></svg>
                                        </div>
                                        <div class="source-name">Solaire</div>
                                        <p class="w-value text-center"><span id="solar-kW">-</span> 
                                    </div>
                                    <div class="widget-content">    
                                        <div class="w-chart">
                                            <div id="w-load-chart-solar"></div>
                                        </div>

                                        <div class="row ml-2 mt-2" style="font-size:12px">
                                            <div class="col">Fourniture</div>
                                            {# <div class="col"><span id="w-solar-fourniture">17</span> kWh</div> #}
                                            <div class="col">-</div>
                                        </div>
                                        <div class="row ml-2" style="font-size:12px">
                                            <div class="col">Contribution</div>
                                            {# <div class="col"><span id="w-solar-contri">5</span> %</div> #}
                                            <div class="col">-</div>
                                        </div>
                                        <div class="row ml-2" style="font-size:12px">
                                            <div class="col">F. charge</div>
                                            {# <div class="col"><span id="w-solar-f-charge">17</span> %</div> #}
                                            <div class="col">-</div>
                                        </div>
                                        <div class="row ml-2 mb-2" style="font-size:12px">
                                            <div class="col">Pmax</div>
                                            {# <div class="col"><span id="w-solar-pmax">12</span> kW</div> #}
                                            <div class="col">-</div>
                                        </div>
                                    </div>
                                </div>
                                
                            </div>
                            
                            <div class="row layout-top-spacing">
                                
                                <div class="widget widget-one_hybrid widget-followers" style="width:230px;background-color:#fff;z-index: 2;">
                                    <div class="widget-heading">
                                        <div class="w-icon source-name">
                                            <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="car-battery" class="svg-inline--fa fa-car-battery fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M480 128h-32V80c0-8.84-7.16-16-16-16h-96c-8.84 0-16 7.16-16 16v48H192V80c0-8.84-7.16-16-16-16H80c-8.84 0-16 7.16-16 16v48H32c-17.67 0-32 14.33-32 32v256c0 17.67 14.33 32 32 32h448c17.67 0 32-14.33 32-32V160c0-17.67-14.33-32-32-32zM192 264c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h112c4.42 0 8 3.58 8 8v16zm256 0c0 4.42-3.58 8-8 8h-40v40c0 4.42-3.58 8-8 8h-16c-4.42 0-8-3.58-8-8v-40h-40c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h40v-40c0-4.42 3.58-8 8-8h16c4.42 0 8 3.58 8 8v40h40c4.42 0 8 3.58 8 8v16z"></path></svg>
                                        </div>
                                        <div class="source-name">Battery</div>
                                        <p class="w-value text-center"><span id="batt-kW">-</span>   
                                        
                                    </div>
                                    <div class="widget-content">    
                                        <div class="w-chart">
                                            <div id="w-load-chart-batt"></div>
                                        </div>

                                        <div class="row ml-2 mt-2" style="font-size:12px">
                                            <div class="col">Fourniture</div>
                                            {# <div class="col"><span id="w-batt-fourniture">5</span> kWh</div> #}
                                            <div class="col">-</div>
                                        </div>
                                        <div class="row ml-2" style="font-size:12px">
                                            <div class="col">Contribution</div>
                                            {# <div class="col"><span id="w-batt-contri">2</span> %</div> #}
                                            <div class="col">-</div>
                                        </div>
                                        <div class="row ml-2" style="font-size:12px">
                                            <div class="col">Niv Charge : </div>
                                            {# <div class="col"><span id="w-batt-niv-charge">85</span>% @ <span id="w-batt-volt">12.5</span>V</div> #}
                                            <div class="col">-</div>
                                        </div>
                                        <div class="row ml-2 mb-2" style="font-size:12px">
                                            <div class="col">Autonomie</div>
                                            {# <div class="col"><span id="w-batt-autonomie">10</span> h</div> #}
                                            <div class="col">-</div>
                                        </div>
                                    </div>
                                </div>
                                
                            </div>
                        </div>
                    </div>
                    <canvas id="canvas" style="position:absolute;top:19px;left:213px"></canvas>
                    
                </div>
                
                
            </div>

            <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-12 layout-top-spacing ">
                <div class="row">
                    <div class="col-12 layout-spacing">
                        <div class="widget widget-one_hybrid widget-followers">
                            <div class="widget-heading">
                                <div class="w-icon source-name">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-map-pin"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
                                </div>
                                <div class="source-name mx-5" id="icon"><img id="wicon" src="" alt="Weather icon"></div>
                                <p class="w-value text-center"><span id="w-temp">-</span> °C | <span id="w-hum">-</span> %rH
                                {# <h5 class="">Consommation du mois en cours</h5> #}
                            </div>
                            <div class="widget-content">    
                                <div class="w-chart">
                                    <div id="w-map-pin"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="row">
                    <div class="col-12 layout-spacing">
                        <div class="widget widget-one_hybrid widget-referral">
                            <div class="widget-heading">
                                <div class="w-icon">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-cloud"><path d="M18 10h-1.26A8 8 0 1 0 9 20h9a5 5 0 0 0 0-10z"></path></svg>
                                </div>
                                <p class="w-value"><span id="w-emission-value">{{kgCO2}}</span> kgCO<sub>2</sub></p>
                                <h5 class="">Empreinte Carbone du mois</h5>
                            </div>
                            <div class="widget-content mt-2">    
                                <div class="w-chart">
                                    <div id="w-co2"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>

        </div>
        
        <div class="statbox widget box layout-spacing layout-top-spacing ">
            <div class="widget-header">                                 
                <div class="row">
                    <div class="col-xl-12 col-md-12 col-sm-12 col-12 d-inline-block">
                        <h5>Historique de données</h5> 
                        <h6 class="float-right"><a href="{{ path('historical_analytic_site_pro_show', {'slug':site.slug}) }}">Allez plus loin</a></h6>
                    </div>
                </div>
            </div>
            <div class="widget-content widget-content-area">
                {# <p>Date time picker is powered by <span class="text-primary">flatpickr.js</span> that gives the ability to user to select date or time.</p> #}
                <div class="form-group mb-0">
                    <input id="daterange" value="2020-10-07" class="form-control flatpickr flatpickr-input active" type="text" placeholder="Select Date..">
                </div>
            </div>
        </div>
        <div class="row widget-statistic layout-top-spacing">
            <div class="col-xl-9 col-lg-9 col-md-9 col-sm-9 col-12 layout-spacing" >
                <div class="widget widget-chart-three layout-spacing layout-top-spacing">
                    <div class="widget-heading">
                        <div class="">
                            <h5 class="">Diagramme de Consommation</h5>
                        </div>

                        <!-- <div class="dropdown  custom-dropdown">
                            <a class="dropdown-toggle" href="#" role="button" id="dropdownMenuLink-1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-horizontal"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg>
                            </a>

                            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuLink-1">
                                <a class="dropdown-item" href="javascript:void(0);">View</a>
                                <a class="dropdown-item" href="javascript:void(0);">Update</a>
                                <a class="dropdown-item" href="javascript:void(0);">Download</a>
                            </div>
                        </div> -->
                    </div>

                    <div class="widget-content">
                        <div id="conso"></div>
                    </div>
                </div>
            </div>
            <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col-12 layout-spacing" >
                <div class="widget widget-chart-three layout-spacing layout-top-spacing">
                    <div class="widget-heading">
                        <div class="">
                            <h5 class="">Conso du site : <span id="total-conso">0</span> kWh</h5>
                        </div>

                        <!-- <div class="dropdown  custom-dropdown">
                            <a class="dropdown-toggle" href="#" role="button" id="dropdownMenuLink-1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-horizontal"><circle cx="12" cy="12" r="1"></circle><circle cx="19" cy="12" r="1"></circle><circle cx="5" cy="12" r="1"></circle></svg>
                            </a>

                            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuLink-1">
                                <a class="dropdown-item" href="javascript:void(0);">View</a>
                                <a class="dropdown-item" href="javascript:void(0);">Update</a>
                                <a class="dropdown-item" href="javascript:void(0);">Download</a>
                            </div>
                        </div> -->
                    </div>

                    <div class="widget-content">
                        <div class="text-center h6 my-2 text-dark">Contribution des Sources</div>
                        <div id="contri-source"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

{% endblock %}

{% block javascripts %}
{# BEGIN PAGE LEVEL PLUGINS/CUSTOM SCRIPTS #}
<script src="/js/scrollspyNav.js"></script>
<script src="/plugins/sweetalerts/sweetalert2.min.js"></script>
<script src="/plugins/sweetalerts/custom-sweetalert.js"></script>
<script src="/plugins/apex/apexcharts.min.js"></script>
<script src="/js/widgets/modules-widgets.js"></script>

<script src="/plugins/moment/moment.js"></script>
{# <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script> #}
<script src="/plugins/daterangepicker/daterangepicker.js"></script>
<script src="/plugins/sweet-alert2/sweetalert2.min.js"></script>

<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
   integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
   crossorigin=""></script>

<!-- Chart JS -->
<script src="/plugins/chartjs/chart.min.js"></script>
{# <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.5.1/chart.min.js" integrity="sha512-Wt1bJGtlnMtGP0dqNFH1xlkLBNpEodaiQ8ZN5JLA5wpc1sUlk/O5uuOMNgvzddzkpvZ9GLyYNa8w2s7rqiTk5Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script> #}

<script src="/plugins/justgage/justgage.js"></script>
<script src="/plugins/justgage/raphael-2.1.4.min.js"></script>
        

<script src="/plugins/highlight/highlight.pack.js"></script>
{# BEGIN PAGE LEVEL PLUGINS/CUSTOM SCRIPTS #}
{# <script src="https://cdn.datatables.net/1.10.22/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.4/js/dataTables.buttons.min.js"></script> #}
<script src="/plugins/datatables/jquery.dataTables.min.js"></script>
<script src="/plugins/datatables/dataTables.buttons.min.js"></script>
{# <script src="https://cdn.datatables.net/1.10.22/js/dataTables.bootstrap4.min.js"></script> #}
<script src="/plugins/datatables/dataTables.bootstrap4.min.js"></script>
<script src="/plugins/datatables/buttons.bootstrap4.min.js"></script>

<script src="/plugins/datatables/jszip.min.js"></script>
{# <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script> #}

{# <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.4/js/buttons.html5.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.4/js/buttons.print.min.js"></script> #}
<script src="/plugins/datatables/pdfmake.min.js"></script>
<script src="/plugins/datatables/vfs_fonts.js"></script>
<script src="/plugins/datatables/buttons.html5.min.js"></script>
<script src="/plugins/datatables/buttons.print.min.js"></script>

{# <script src="https://cdn.datatables.net/buttons/1.6.4/js/buttons.colVis.min.js"></script> #}
<!-- Responsive examples -->
{# <script src="https://cdn.datatables.net/1.10.22/js/dataTables.bootstrap4.min.js"></script> #}
{# <script src="https://cdn.datatables.net/1.10.22/js/dataTables.bootstrap4.min.js"></script> #}

{# Overview tab panel scripts #}
<script>
    var canvas = document.getElementById('canvas');
    var delay = 100;
    var canvasWidth;
    var canvasHeight;
    var blockSize = 4;
    var timeOut;
    nbSnake = 0;
    var gridSnakeCoord = {
        x: 0,
        y: 45
    }

    /*var srcNbSnake = [
        "grid"      => 0,
        "genset"    =>  0,
        "solar"     => 0,
        "battery"   =>  0
    ];*/

    var srcSnake = {
        "grid"      : [],
        "genset"    :  [],
        "solar"     : [],
        "battery"   :  []
    };

    var srcState = {
        "grid"      : {{ gensetData['CGCR']['CR'] }},
        "genset"    : {{ gensetData['CGCR']['CG'] }},
        "solar"     : false,
        "battery"   : false
    };

    var srcSnakeCoord = {
        "grid" : {
            x: [0, 11],
            y: 45
        },
        "genset"    :  {
            x: [0, 11],
            y: 79
        },
        "solar"     : {
            x: [114, 123],//92,
            y: 45
        },
        "battery"   :  {
            x: [114, 123],//92,
            y: 79
        },
    };

    var srcSnakeDir = {
        "grid"      : "right-grid",
        "genset"    : "right-genset",
        "solar"     : "left-solar",
        "battery"   : "left-battery"
    };

    var srcCollission = {
        "grid"      : {
            x: 19,
            y: [45, 62],
            dir: ["down", "right"],
            collisionType: ["grid-Collision", "AC-Collision"]
        },
        "genset"    :  {
            x: 19,
            y: [79, 62],
            dir: ["up", "right"],
            collisionType: ["genset-Collision", "AC-Collision"]
        },
        "solar"     : {
            x: 94,//92,
            y: [45, 62],
            dir: ["down", "left"],
            collisionType: ["solar-Collision", "DC-Collision"]
        },
        "battery"   :  {
            x: 94,//92,
            y: [79, 62],
            dir: ["up", "left"],
            collisionType: ["battery-Collision", "DC-Collision"]
        },
        "T"   :  {
            x: 56,
            y: 62,
            dir: "down",
            collisionType: "T-Collision"
        },
        "Load"   :  {
            x: 56,
            y: 99,
            dir: "down",
            collisionType: "Load-Collision"
        }
    };

    var gridSnake = [];

    var gensetSnakeCoord = {
        x: 0,
        y: 79
    }
    var gensetSnake = [];

    var solarSnakeCoord = {
        x: 114,//92,
        y: 45
    }
    var solarSnake;
    {# canvas.width = 453;
    canvas.height = 388; #}
    
    function resize(){    
        canvas.height = window.innerHeight * 0.515;
        canvas.width = window.innerWidth * 0.315;
        canvasWidth = canvas.width;
        canvasHeight = canvas.height;
        // $("#canvas").outerHeight($(window).height()-$("#canvas").offset().top- Math.abs($("#canvas").outerHeight(true) - $("#canvas").outerHeight()) ); 
        console.log("canvas.width = " + canvas.width)
        console.log("canvas.height = " + canvas.height)
    }
    
    $(document).ready(function(){
        resize();
        initCanvas();
        $(window).on("resize", function(){                      
            resize();
            initCanvas();
        });
    });
    var ctx = canvas.getContext("2d");
    ctx.lineWidth = 0.5;
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
        
    e = 5;
    
    //initCanvas();
    {# setTimeout(function(){
        console.log("30s eleapsed");
        srcState["grid"]   = false;
        srcState["genset"] = true;

        addSnake("genset");
    }, 30000); #}
    
    function initCanvas(){
        //ctx.clear()
        srcSnake = {
            "grid"    : [],
            "genset"  : [],
            "solar"   : [],
            "battery" : []
        };

        /*srcState = {
            "grid"      : false,
            "genset"    : false,
            "solar"     : false,
            "battery"   : false
        };*/

        {# srcState["solar"] = true;
        srcState["battery"] = true; #}
        for (var srcType in srcSnake) {
            //console.log("srcType value = " + srcType);
            //console.log("srcType typeof = " + typeof srcType);
            addSnake(srcType);
        }
        
        {# snake = new Snake([[gridSnakeCoord.x+18,gridSnakeCoord.y],[gridSnakeCoord.x-1+18,gridSnakeCoord.y],[gridSnakeCoord.x-2+18,gridSnakeCoord.y]], "right-grid", gridSnake.length);
        gridSnake.push(snake);
        nbSnake = gridSnake.length; #}

        snake = new Snake([[gensetSnakeCoord.x,gensetSnakeCoord.y],[gensetSnakeCoord.x-1,gensetSnakeCoord.y],[gensetSnakeCoord.x-2,gensetSnakeCoord.y]], "right-genset");
        gensetSnake.push(snake);
        snake = new Snake([[gensetSnakeCoord.x,gensetSnakeCoord.y],[gensetSnakeCoord.x-1+9,gensetSnakeCoord.y],[gensetSnakeCoord.x-2+9,gensetSnakeCoord.y]], "right-genset");
        gensetSnake.push(snake);
        //refreshCanvas();
        clearInterval(timeOut);
        timeOut = setInterval(refreshCanvas, delay);
        
        {# ctx.fillStyle = "#668ff6";
        ctx.fillRect(19,181,blockSize,blockSize)
        ctx.fillRect(16,181,blockSize,blockSize)
        ctx.fillRect(13,181,blockSize,blockSize) #}
    }

    function addSnake(type){
        if( srcState[type] == true) {
            var snake;
            /*if(srcSnake[type].length == 0){
                snake = new Snake(type, [[srcSnakeCoord[type].x[1],srcSnakeCoord[type].y],[srcSnakeCoord[type].x[1]-1,srcSnakeCoord[type].y],[srcSnakeCoord[type].x[1]-2,srcSnakeCoord[type].y]], srcSnakeDir[type], srcSnake[type].length);
                srcSnake[type].push(snake);
            }*/
            snake = new Snake(type, [[srcSnakeCoord[type].x[0],srcSnakeCoord[type].y],[srcSnakeCoord[type].x[0]-1,srcSnakeCoord[type].y],[srcSnakeCoord[type].x[0]-2,srcSnakeCoord[type].y]], srcSnakeDir[type], srcSnake[type].length);
            srcSnake[type].push(snake);

        }
    }

    /*function addSnake(){
        var snake = new Snake("grid", [[gridSnakeCoord.x,gridSnakeCoord.y],[gridSnakeCoord.x-1,gridSnakeCoord.y],[gridSnakeCoord.x-2,gridSnakeCoord.y]], gridSnake.length, "right-grid");
        //gensetSnake = new Snake([[gensetSnakeCoord.x,gensetSnakeCoord.y],[gensetSnakeCoord.x-1,gensetSnakeCoord.y],[gensetSnakeCoord.x-2,gensetSnakeCoord.y]], "right-genset");
        //solarSnake = new Snake([[solarSnakeCoord.x-1,solarSnakeCoord.y],[solarSnakeCoord.x-2,solarSnakeCoord.y],[solarSnakeCoord.x,solarSnakeCoord.y]], "left-solar");
        gridSnake.push(snake);
        nbSnake = gridSnake.length;
        console.log("Nb Snake = " + nbSnake);
        // snake = new Snake("grid", [[gridSnakeCoord.x+13,gridSnakeCoord.y],[gridSnakeCoord.x-1+13,gridSnakeCoord.y],[gridSnakeCoord.x-2+13,gridSnakeCoord.y]], "right-grid");
        //gridSnake.push(snake);
        //nbSnake = gridSnake.length;

        //snake = new Snake("grid", [[gridSnakeCoord.x+25,gridSnakeCoord.y],[gridSnakeCoord.x-1+25,gridSnakeCoord.y],[gridSnakeCoord.x-2+25,gridSnakeCoord.y]], "right-grid");
        //gridSnake.push(snake);
        //nbSnake = gridSnake.length;

        console.log(gridSnake);
    }*/

    function drawCircuit(){
        //========== AC source ==========
        //Grid Z-Line
        ctx.beginPath();
        x0 = 0; y0 = 180
        ctx.moveTo(x0, y0);
        dx0 = 80;
        x1 = x0+dx0; y1 = y0;
        ctx.lineTo(x1, y1);
        dy0 = 68;
        x2 = x1; y2 = y1 + dy0;
        ctx.lineTo(x2, y2);
        dx1 = 40
        x3 = x2 + dx1; y3 = y2
        ctx.lineTo(x3, y3);
        ctx.stroke();
        ctx.closePath();
        
        //inverse C-Line
        ctx.beginPath();
        x0 = 0; y0 += e
        ctx.moveTo(x0, y0);
        dx0 = 75;
        x1 = x0+dx0; y1 = y0;
        ctx.lineTo(x1, y1);
        dy0 = 130;
        x2 = x1; y2 = y1 + dy0;
        ctx.lineTo(x2, y2);
        dx1 = x0
        x3 = x0; y3 = y2
        ctx.lineTo(x3, y3);
        ctx.stroke();
        ctx.closePath();
        
        //Genset inverse Z-Line
        ctx.beginPath();
        x0 = 0; y0 = y3+e
        ctx.moveTo(x0, y0);
        dx0 = 80;
        x1 = x0+dx0; y1 = y0;
        ctx.lineTo(x1, y1);
        dy0 = -67;
        x2 = x1; y2 = y1 + dy0;
        ctx.lineTo(x2, y2);
        dx1 = 40
        x3 = x2 + dx1; y3 = y2
        ctx.lineTo(x3, y3);
        ctx.stroke();
        ctx.closePath();

        c = 50;
        xr = 120; yr = 228;
        ctx.save();
        ctx.fillStyle = "#668ff6";
        ctx.fillRect(xr,yr,c,c);
        ctx.restore();

        ctx.save();
        ctx.fillStyle = "white";
        //ctx.textAlign = "center";
        //ctx.textBaseline = "middle";
        ctx.font = "9px sans-serif";
        ctx.fillText("Inverseur", xr+4, yr+(c/2)+2);
        ctx.restore();

        //========== DC source ==========
        xr = canvas.width - 120; yr = 228;
        ctx.save();
        ctx.fillStyle = "#668ff6";
        ctx.fillRect(xr,yr,-c,c);
        ctx.restore();
        
        ctx.save();
        ctx.fillStyle = "white";
        ctx.strokeStyle = "white";
        //ctx.textAlign = "center";
        //ctx.textBaseline = "middle";
        ctx.font = "9px sans-serif";
        ctx.fillText("Onduleur", xr-c+4, yr+(c/2)+2);
        ctx.restore();

        //Solar inverse Z-Line
        ctx.beginPath();
        x0 = canvas.width; y0 = 180
        ctx.moveTo(x0, y0);
        dx0 = -78.1;
        x1 = x0+dx0; y1 = y0;
        ctx.lineTo(x1, y1);
        dy0 = 68;
        x2 = x1; y2 = y1 + dy0;
        ctx.lineTo(x2, y2);
        dx1 = -41
        x3 = x2 + dx1; y3 = y2
        ctx.lineTo(x3, y3);
        ctx.stroke();
        ctx.closePath();

        //C-Line
        ctx.beginPath();
        x0 = canvas.width; y0 += e
        ctx.moveTo(x0, y0);
        dx0 = -73;
        x1 = x0+dx0; y1 = y0;
        ctx.lineTo(x1, y1);
        dy0 = 130;
        x2 = x1; y2 = y1 + dy0;
        ctx.lineTo(x2, y2);
        dx1 = x0
        x3 = x0; y3 = y2
        ctx.lineTo(x3, y3);
        ctx.stroke();
        ctx.closePath();
        
        //Battery Z-Line
        ctx.beginPath();
        x0 = canvas.width; y0 = y3+(e+1)
        ctx.moveTo(x0, y0);
        dx0 = -78.1;
        x1 = x0+dx0; y1 = y0;
        ctx.lineTo(x1, y1);
        dy0 = -68;
        x2 = x1; y2 = y1 + dy0;
        ctx.lineTo(x2, y2);
        dx1 = -41
        x3 = x2 + dx1; y3 = y2
        ctx.lineTo(x3, y3);
        ctx.stroke();
        ctx.closePath();

        //========== Interconnexion ==========
        //Horizontal Line
        ctx.beginPath();
        x0 = 120+c; y0 = 248;
        ctx.moveTo(x0, y0);
        dx0 = 112;
        x1 = x0+dx0; y1 = y0;
        ctx.lineTo(x1, y1);
        ctx.stroke();
        ctx.closePath();

        //AC T-Line
        ctx.beginPath();
        x0 = x0; y0 += e
        ctx.moveTo(x0, y0);
        dx0 = 53;
        x1 = x0+dx0; y1 = y0;
        ctx.lineTo(x1, y1);
        dy0 = 136;
        x2 = x1; y2 = y1 + dy0;
        ctx.lineTo(x2, y2);
        ctx.stroke();
        ctx.closePath();
        
        //DC T-Line
        ctx.beginPath();
        x0 = 282; y0 = y0;
        ctx.moveTo(x0, y0);
        dx0 = -54;
        x1 = x0+dx0; y1 = y0;
        ctx.lineTo(x1, y1);
        dy0 = 136;
        x2 = x1; y2 = y1 + dy0;
        ctx.lineTo(x2, y2);
        ctx.stroke();
        ctx.closePath();


    }

    function refreshCanvas(){
        ctx.clearRect(0, 0, canvasWidth, canvasHeight);
        var coll = "";
        var index;
        //var srcSnakeClone = JSON.stringify(srcSnake);
        //srcSnakeClone = JSON.parse(srcSnakeClone);
        var srcSnakeClone = { ...srcSnake };
        for (var key in srcSnake) {
            var value = srcSnake[key];
            ///console.log(key, value);
            if(value.length > 0){
                //console.log(key + " array length = " + value.length);
                for(var i = 0; i < value.length; i++){
                    value[i].advance();
                    coll = value[i].checkCollision();
                    //if(coll !== "no collision") console.log(key + " snake[" + i + "] : " + coll);
                    //if(coll === srcCollission["Load"].collisionType) index = i;
                    if(coll === srcCollission["Load"].collisionType){
                        var newArray = srcSnakeClone[key].filter(function(f) { return f !== value[i] });
                        srcSnakeClone[key] = newArray;
                    };
                    value[i].draw();
                }
                /*if(coll === srcCollission["Load"].collisionType){
                    console.log(key + " array length before splice = " + value.length);
                    value.splice(index, 1);
                    console.log(key + " array length after splice = " + value.length);
                    //value.shift();
                    //console.log("Nb Snake = " + value.length);
                    console.log(value);
                }*/
            }
        }
        {# console.log("refresh nbSnake :" + nbSnake)
        for(var i = 0; i < nbSnake; i++){
            gridSnake[i].advance();
            coll = gridSnake[i].checkCollision();
            if(coll === "LoadCollision") index = i;
            gridSnake[i].draw();
        }

        if(coll === "Load-Collision"){
            gridSnake.splice(index, 1);
            //gridSnake.shift();
            console.log("Nb Snake = " + nbSnake);
            nbSnake = gridSnake.length;
            console.log("Nb Snake = " + nbSnake);
            console.log(gridSnake);
        } #}

        {# gensetSnake.advance();
        gensetSnake.checkCollision();
        gensetSnake.draw();

        solarSnake.advance();
        solarSnake.checkCollision();
        solarSnake.draw(); #}

        drawCircuit();

        srcSnake = srcSnakeClone;
        /*for (var key in srcSnake) {
            var value = srcSnake[key];
            ///console.log(key, value);
            if(value.length > 0){
                console.log("========= " + key + " array ========= ");
                console.log(value);
            }
        }*/
        //clearTimeout(timeOut);
        //timeout = setTimeout(refreshCanvas, delay);
    }

    function drawBlock(ctx, position){
        var x = position[0] * blockSize;
        var y = position[1] * blockSize;
        ctx.fillRect(x, y, blockSize, blockSize)
    }

    function Snake(type, body, direction, index){
        this.body = body;
        this.direction = direction;
        this.index = index;
        this.type = type;

        this.draw = function(){
            ctx.save();
            ctx.fillStyle = "#668ff6";
            for(var i = 0; i < this.body.length; i++){
                drawBlock(ctx, this.body[i])
            }
            ctx.restore();
        };

        this.advance = function(){
            var nextPosition = this.body[0].slice();
            switch(this.direction) {
                case "left":
                    nextPosition[0] -= 1;
                    break;
                case "left-solar":
                    nextPosition[0] -= 1;
                    break;
                case "left-battery":
                    nextPosition[0] -= 1;
                    break;
                case "right":
                    nextPosition[0] += 1;
                    break;
                case "right-grid":
                    nextPosition[0] += 1;
                    break;
                case "right-genset":
                    nextPosition[0] += 1;
                    break;
                case "down":
                    nextPosition[1] += 1;
                    break;
                case "down-grid":
                    nextPosition[1] += 1;
                    break;
                case "down-solar":
                    nextPosition[1] += 1;
                    break;
                case "left":
                    nextPosition[0] -= 1;
                    break;
                case "right":
                    nextPosition[0] += 1;
                    break;
                case "down":
                    nextPosition[1] += 1;
                    break;
                case "up":
                    nextPosition[1] -= 1;
                    break;
                default:
                    throw("Invalid Direction");
            }
            this.body.unshift(nextPosition);
            this.body.pop();
        }

        this.setDirection = function(newDirection){
            var allowedDirections;
            switch(this.direction){
                case "left-solar":
                    allowedDirections = ["down"];
                    break;
                case "left-battery":
                    allowedDirections = ["up"];
                    break;
                case "right-grid":
                    allowedDirections = ["down"];
                    break;
                case "down-grid":
                    allowedDirections = ["right"];
                    break;
                case "right-genset":
                    allowedDirections = ["up"];
                    break;
                case "up-genset":
                    allowedDirections = ["right"];
                    break;
                case "left":
                case "right":
                    allowedDirections=["up","down"];
                    break;
                case "down":
                case "up":
                    allowedDirections=["left","right"];
                    break;
                default:
                    throw("Invalid Direction");
            }
            if(allowedDirections.indexOf(newDirection) >-1){
                this.direction = newDirection;
            }
        }

        this.checkCollision = function(){
        /*var gridZ1Collision = false;
            var gridZ2Collision = false;
            var gensetZ1Collision = false;
            var gensetZ2Collision = false;
            var TCollision = false;
            var LoadCollision = false;
            var solarZ1Collision = false;
            var solarZ2Collision = false;
        */
            var head = this.body[0];
            var rest = this.body.slice(1);
            var snakeX = head[0];
            var snakeY = head[1];
            
        /*    var gridZ1X = 19;
            var gridZ1Y = 45;
            
            var gridZ2X = 19;
            var gridZ2Y = 62;

            var solarZ1X = 72;
            var solarZ1Y = 45;
            
            var solarZ2X = 72;
            var solarZ2Y = 62;

            var gensetZ1X = 19;
            var gensetZ1Y = 79;
            // var gensetZ2X = 19;
            //var gensetZ2Y = 62; 
        

            var TX = 56;
            var TY = 62;

            var LoadX = 56;
            var LoadY = 99;
            console.log('X = ' + snakeX + ' Y = ' + snakeY);
        
            var gridZ1Walls = snakeX === gridZ1X && snakeY === gridZ1Y;
            var gridZ2Walls = snakeX === gridZ2X && snakeY === gridZ2Y;
            var gensetZ1Walls = snakeX === gensetZ1X && snakeY === gensetZ1Y;
            // var gensetZ2Walls = snakeX === gensetZ2X && snakeY === gensetZ2Y; 
            var TWalls = snakeX === TX && snakeY === TY;
            var LoadWalls = snakeX === LoadX && snakeY === LoadY;
            var solarZ1Walls = snakeX === solarZ1X && snakeY === solarZ1Y;
            var solarZ2Walls = snakeX === solarZ2X && snakeY === solarZ2Y;
        */    
            if ( (snakeX === srcCollission[this.type].x) && (snakeY === srcCollission[this.type].y[0]) ){
                this.setDirection(srcCollission[this.type].dir[0]);
                //clearTimeout(timeOut);
                //console.log("nb Snake after me = " + (nbSnake - (this.index+1)));
                addSnake(this.type);
                return srcCollission[this.type].collisionType[0];
            }
            if ( (snakeX === srcCollission[this.type].x) && (snakeY === srcCollission[this.type].y[1]) ){
                this.setDirection(srcCollission[this.type].dir[1]);
                //if(srcSnake[this.type].length - (this.index+1) < 3) addSnake(this.type);
                return srcCollission[this.type].collisionType[1];
            }
            if ( (snakeX === srcCollission["T"].x) && (snakeY === srcCollission["T"].y) ){
                this.setDirection(srcCollission["T"].dir);
                //if(srcSnake[this.type].length - (this.index+1) < 4) addSnake(this.type);
                return srcCollission["T"].collisionType;
            }
            if ( (snakeX === srcCollission["Load"].x) && (snakeY === srcCollission["Load"].y) ){
                //addSnake(this.type);
                return srcCollission["Load"].collisionType;
            }

            //return gridZ1Collision || gridZ2Collision;
            return "no collision";
        }
    }

    function changeDirection(snake){
        var newDirection;
        switch(snake.direction){
            case "left-solar":
                newDirection = "down";
                break;
            case "left-battery":
                newDirection = "up";
                break;
            case "right-grid":
                newDirection = "down";
                break;
            case "down-grid":
                newDirection = "right";
                break;
            case "right-genset":
                newDirection = "up";
                break;
            case "up-genset":
                newDirection = "right";
                break;
            default:
                throw("Invalid Direction");
        }
        snake.setDirection(newDirection);
    }

    document.onkeydown = function handleKeyDown(e){
        var key = e.keyCode;
        var newDirection;
        switch(key){
            case 37:
                newDirection = "left";
                break;
            case 38:
                newDirection = "up";
                break;
            case 39:
                newDirection = "right";
                break;
            case 40:
                newDirection = "down";
                break;
            case 32:
                //restart();
                return;
            default:
                return;
        }
        gridSnake.setDirection(newDirection);
        //gensetSnake.setDirection(newDirection);
        //solarSnake.setDirection(newDirection);
    };
    /* // translate context to center of canvas
    context.translate(canvas.width / 2, canvas.height / 2);

    // flip context horizontally
    context.scale(-1, 1); */
    {# var cd;
    var ctx2;
    var startPoint;
    var endPoint;
    var midPoint;

    function init() {
        cd = document.getElementById("canvas");
        cd.width = 500;
        cd.height = 500;

        ctx2 = cd.getContext("2d");
    }


    function draw() {
        startPoint = {
            x: 0,
            y: 95
        };
        endPoint = {
            x: startPoint.x + 100,
            y: startPoint.y 
        };

        ctx2.beginPath();
        // ctx2.setLineDash([1, 2]); 
        ctx2.moveTo(startPoint.x, startPoint.y);
        ctx2.lineTo(endPoint.x, endPoint.y);
        ctx2.stroke();
        ctx2.closePath();
        
        ctx2.save()
        ctx2.beginPath();
        ctx2.setLineDash([1, 2]);
        
        // rotate around center - find mid-point using lerp
        midPoint = {
            x: startPoint.x + (endPoint.x - startPoint.x) * 0.5,
            y: startPoint.y + (endPoint.y - startPoint.y) * 0.5
        };
        
        // translate to midpoint
        // ctx2.translate(midPoint.x, midPoint.y); 
        ctx2.translate(endPoint.x, endPoint.y);
        
        // rotate some angle (radians)
        ctx2.rotate(0.5 * Math.PI);  // = 45°
        
        // translate back
        ctx2.translate(-endPoint.x, -endPoint.y);

        // draw line
        ctx2.moveTo(startPoint.x, startPoint.y);
        ctx2.lineTo(endPoint.x, endPoint.y);
        ctx2.stroke();
        ctx2.closePath();
        
        // reset transforms
        ctx2.setTransform(1,0,0,1,0,0);
    }

    init();
    draw();  #}

</script>

<script>

    // Where you want to render the map.
    var element = document.getElementById('w-map-pin');

    // Height has to be set. You can do this in CSS too.
    element.style = 'height:300px;';

    var map = L.map('w-map-pin').setView([{{site.latitude}}, {{site.longitude}}], 13);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    }).addTo(map);

    L.marker([{{site.latitude}}, {{site.longitude}}]).addTo(map)
        .bindPopup('{{site.name}}.<br><span style="text-align: center">lat:{{site.latitude}}, long:{{site.longitude}}</span>')
        .openPopup();
</script> 

<script>
    var now = new Date();
    //var jsDate = now.getDate()+'-'+(now.getMonth()+1)+'-'+now.getFullYear();
    var FileNameGridBill = 'Récap Grid | ' + now.getFullYear();
    var historicGridBillTable = $('#historic-gridBill-dataTable').DataTable({
        //lengthChange: false,
        //buttons: ['copy', 'excel', 'pdf', 'colvis']
        //buttons: ['excel', 'pdf'],
        searching: false, 
        paging: false, 
        info: false,
        order: [],
        ordering: false,
        lengthChange: false,
        //buttons: ['copy', 'excel', 'pdf', 'colvis']
        buttons: [
            {
                //text: 'Exporter Disponibilité',
                extend: 'pdfHtml5',
                filename: 'Récap Grid - ' + now.getFullYear(),//function () { return getExportFileName();},//
                exportOptions: {
                    //columns: [ 0, 1, 4 ],
                    //columns: ':visible'
                    search: 'applied',
                    order: 'applied'
                },
                title: function( thead, data, start, end, display ) {
                    return "{{site.name}}\r\n" + FileNameGridBill;
                },
                customize: function (doc) {
                    //Remove the title created by datatTables
                    
                    //Create a date string that we use in the footer. Format is dd-mm-yyyy
                    var now = new Date();
                    var jsDate = now.getDate()+'-'+(now.getMonth()+1)+'-'+now.getFullYear();
                    // Logo converted to base64
                    // var logo = getBase64FromImageUrl('https://datatables.net/media/images/logo.png');
                    // The above call should work, but not when called from codepen.io
                    // So we use a online converter and paste the string in.
                    // Done on http://codebeautify.org/image-to-base64-converter
                    // It's a LONG string scroll down to see the rest of the code !!!
                    //var logo = 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBDAAICAgICAQICAgIDAgIDAwYEAwMDAwcFBQQGCAcJCAgHCAgJCg0LCQoMCggICw8LDA0ODg8OCQsQERAOEQ0ODg7/2wBDAQIDAwMDAwcEBAcOCQgJDg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg7/wAARCAAwADADASIAAhEBAxEB/8QAGgAAAwEAAwAAAAAAAAAAAAAABwgJBgIFCv/EADUQAAEDAgQDBgUDBAMAAAAAAAECAwQFBgAHESEIEjEJEyJBUXEUI0JhgRVSYhYXMpEzcrH/xAAYAQADAQEAAAAAAAAAAAAAAAAEBQYHAv/EAC4RAAEDAgMGBQQDAAAAAAAAAAECAxEABAUGEhMhMUFRcSIyYaHBFkKB0ZGx8P/aAAwDAQACEQMRAD8Avy44hlhTrqw22kEqUo6BIG5JPkMSxz67RlFPzFquWnDParOaN4QVlmqXDKcKKLS19CCsf8qh6A6e+OfaK573LDTanDJllVV0q8r3ZVIuGqR1fMpdJSdHCCOinN0j7e+FjymydjRKdSbGsikpbSlG5O3/AHfeX5nU6knck6DFdg+DovkquLlWllHE8yeg+f4FBPvluEpEqNC657/4yr4ecm3ZxH1OghzxfptpQERI7X8QrqdPXGNpucXGLltU0SbZ4jazW0tHX4C6IiJcd37HUEj8YoHNtTKOzwuHVPj79rTfhkfCudxEbUOqQQd9Pc4HlaoGRt2JVAcptRsOe54WZZkd6yFHpzakgD3098ahYWuVVDQ/YrKD9wJnvGqfb8UAHH584npWw4eu0+iVO+6Vl3xO2zHy1uKa4GafdcBwqos5w7AOE6lgk+epT68uK8MvNPxmnmHEvMuJCm3EKCkqSRqCCNiCPPHmbzdyWcozkq1rpitVSkzGyqHNbT4HU+S0H6Vp22/9Bw8XZkcQ1wuzLg4V8yqq5U69a0X42zalJXq5NpeuhZJO5LWo0/idPpxI5ryszgyG77D3Nrau+U8weh/cDgQRI3sGXi54VCCKXK6Ku5fnbOcTt2znO/8A0SfFtymcx17llpGqgPTUjDj5WOIOUmYFPpLgjXQ5ES627r43I6R40I9D16fuGEfzPZeyq7afiRtec0W03O/GuSj82wdbdb8ZB89FEjb0xvrIzGk2pmnSrgcdUttl3lkoB2UyrZadPbf8DFFhGHuX+W0bASUyY6kKJg96XPK0XJmt9MrkFuIQw2XNup8IwFbruVaWXkttMgadCCcEfNuPTbbzPkiK87+jVRsTqctlIKVNubkD2J/0RgBVFDVQUpTTEksjdTjpG4xc4TYOvBu5AhB3yf8AcfmgTIUUmiMxcs27+CG42Koy3JqFqym3YLytebuVfRr9gVD2AwvOWt5u2f2qXDle0FK4UhVwijzgFbPMSUlBSftqdcMAqN/TfCVV0yGBDl3O+huMwvZXw6Oqzr67n8jC85VWw/fnakZD2tAaL/wtwGsSuTfu2YyCeY+6ikY5x1yzVlDECB4C8Nn3lEx6SFe9MWtW3R1jfVTu0l4a7lv6wbaz8yqp6p2gridZ2X6FmXT2U6uVelq8TrQA3UtG6gPMFQG+mJe2Xf8ASL5s1qp0p35qfDLhuHR2M4P8kLT5aH/ePUSpIUnQjUemJh8SXZs2fmVf8/MvJevKyfzNkEuTPhGeamVNZ3JeZGnKonqpPXqQTjE8tZmdwF4hSdbSjvHMHqP1zo24tw8J4EUn9MvWz7iymo9tX27PgTqQ4tMCfGY735SuiFdenTTTyGOIrGV1DSJLCqndb7Z1aamIDEZJHQqGg5vyDga3Fw28bVhS1wqrlHAzAjtkhFSt2sIQHR5HkXoQftjrqJw5cYt81BESDkuxaCVnRU24K0Fpb+/I3qT7Y1b6kygptSi88lKiSWxIEkyRygE8tUUDsbieA71mM2M0mZxlVytTQ0w0jkQlIIQ2PpabR1JJ6Abk4oP2bHDhW6O9WuITMKlLplxV9hMeg06Sn5lPgjdIUPJayedX4HljvOHvs16VbF7Uy/c86/8A3DuyIoOwoAaDdPgL66ts7gqH7lan2xVaJEjQaezFiMIjx2khLbaBoEgYyzMmZTjWi2t0bK3b8qfk+v8AW/jNMGWdn4lGVGv/2SAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA=';
                    // A documentation reference can be found at
                    // https://github.com/bpampuch/pdfmake#getting-started
                    // Set page margins [left,top,right,bottom] or [horizontal,vertical]
                    // or one number for equal spread
                    // It's important to create enough space at the top for a header !!!
                    doc.pageMargins = [60,60,60,30];
                    // Set the font size fot the entire document
                    doc.defaultStyle.fontSize = 12;
                    // Set the fontsize for the table header
                    doc.styles.tableHeader.fontSize = 13;
                    //doc.styles.tableBodyOdd.fillColor = "yellow";
                    {# doc.styles.tableBodyOdd.alignment = function (rowIndex, node, columnIndex) {
                                                    //return (rowIndex >= 0) ? 'center' : null;
                                                    return 'center';
                                                }; #}
                    doc.styles.tableBodyEven.alignment = 'center';
                    doc.styles.tableBodyOdd.alignment = 'center'; 
                    {# doc.styles.tableHeader.fillColor = "#6c757d"; #}
                    console.log(doc);
                    var objTable = {};
                    //objTable['heights'] = (function(i) { return 100; });
                    //objTable['widths'] = ['*', 'auto', '*', 'auto', 'auto', 'auto'];
                    //objTable['widths']   = (function(i) { return ['*', 'auto', '*', 'auto', 'auto', 'auto']; });
                    //doc.content[1].table = objTable; 
                    doc.content[1].table.widths = ['auto', '*', 'auto', '*']; 
                    //doc.content[1].table.heights = (function(i) { return 100; }); 
                    {# doc.content[1].layout = {
                                                fillColor: function (rowIndex, node, columnIndex) {
                                                    return (rowIndex % 2 === 0) ? '#CCCCCC' : null;
                                                }
                                            };  #}
                        
                    // Create a header object with 3 columns
                    // Left side: Logo
                    // Middle: brandname
                    // Right side: A document title
                    /*doc['header']=(function() {
                        return {
                            columns: [
                                {
                                    //image: logo,
                                    "width": 24
                                },
                                {
                                    alignment: 'left',
                                    italics: true,
                                    text: 'dataTables',
                                    fontSize: 18,
                                    margin: [10,0]
                                },
                                {
                                    alignment: 'right',
                                    fontSize: 14,
                                    text: 'Custom PDF export with dataTables'
                                }
                            ],
                            margin: 20
                        }
                    });*/
                    // Create a footer object with 2 columns
                    // Left side: report creation date
                    // Right side: current page and total pages
                    doc['footer']=(function(page, pages) {
                        return {
                            columns: [
                                {
                                    alignment: 'left',
                                    text: ['Crée le : ', { text: jsDate.toString() }]
                                },
                                {
                                    alignment: 'center',
                                    text: ['{{app.user.enterprise.socialReason}} {% if app.user.enterprise.niu is not empty %}- NIU : {{app.user.enterprise.niu}} {% endif %} {% if app.user.enterprise.rccm is not empty %}- RCCM : {{app.user.enterprise.rccm}}{% endif %}']
                                },
                                {
                                    alignment: 'right',
                                    text: ['page ', { text: page.toString() },	'/',	{ text: pages.toString() }]
                                }
                            ],
                            margin: [10, 0]
                        }
                    });
                    console.log(doc['footer'])
                    // Change dataTable layout (Table styling)
                    // To use predefined layouts uncomment the line below and comment the custom lines below
                    // doc.content[0].layout = 'lightHorizontalLines'; // noBorders , headerLineOnly
                    var objLayout = {};
                    objLayout['hLineWidth']   = (function(i) { return .5; });
                    objLayout['vLineWidth']   = (function(i) { return .5; });
                    objLayout['hLineColor']   = (function(i) { return '#ccc'; });
                    objLayout['vLineColor']   = (function(i) { return '#ccc'; });
                    objLayout['paddingLeft']  = (function(i) { return 4; });
                    objLayout['paddingRight'] = (function(i) { return 4; });
                    doc.content[0].layout = objLayout;
                } 
            },
            {
                //text: 'Exporter Disponibilité',
                extend: 'excel',
                filename: FileNameGridBill,
                exportOptions: {
                    //columns: [ 0, 1, 4 ],
                    //columns: ':visible'
                    search: 'applied',
                    order: 'applied'
                },
            }
        ] 
    });

    historicGridBillTable.buttons().container().appendTo('#historic-gridBill-dataTable_wrapper .col-md-6:eq(0)');
    
    var FileNameFuelBill = 'Récap Fuel | ' + now.getFullYear();
    var historicFuelBillTable = $('#historic-fuelBill-dataTable').DataTable({
        //lengthChange: false,
        //buttons: ['copy', 'excel', 'pdf', 'colvis']
        //buttons: ['excel', 'pdf'],
        searching: false, 
        paging: false, 
        info: false,
        order: [],
        ordering: false,
        lengthChange: false,
        //buttons: ['copy', 'excel', 'pdf', 'colvis']
        buttons: [
            {
                //text: 'Exporter Disponibilité',
                extend: 'pdfHtml5',
                filename: 'Récap Fuel - ' + now.getFullYear(),//function () { return getExportFileName();},//
                exportOptions: {
                    //columns: [ 0, 1, 4 ],
                    //columns: ':visible'
                    search: 'applied',
                    order: 'applied'
                },
                title: function( thead, data, start, end, display ) {
                    return "{{site.name}}\r\n" + FileNameGridBill;
                },
                customize: function (doc) {
                    //Remove the title created by datatTables
                    
                    //Create a date string that we use in the footer. Format is dd-mm-yyyy
                    var now = new Date();
                    var jsDate = now.getDate()+'-'+(now.getMonth()+1)+'-'+now.getFullYear();
                    // Logo converted to base64
                    // var logo = getBase64FromImageUrl('https://datatables.net/media/images/logo.png');
                    // The above call should work, but not when called from codepen.io
                    // So we use a online converter and paste the string in.
                    // Done on http://codebeautify.org/image-to-base64-converter
                    // It's a LONG string scroll down to see the rest of the code !!!
                    //var logo = 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/2wBDAAICAgICAQICAgIDAgIDAwYEAwMDAwcFBQQGCAcJCAgHCAgJCg0LCQoMCggICw8LDA0ODg8OCQsQERAOEQ0ODg7/2wBDAQIDAwMDAwcEBAcOCQgJDg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg4ODg7/wAARCAAwADADASIAAhEBAxEB/8QAGgAAAwEAAwAAAAAAAAAAAAAABwgJBgIFCv/EADUQAAEDAgQDBgUDBAMAAAAAAAECAwQFBgAHESEIEjEJEyJBUXEUI0JhgRVSYhYXMpEzcrH/xAAYAQADAQEAAAAAAAAAAAAAAAAEBQYHAv/EAC4RAAEDAgMGBQQDAAAAAAAAAAECAxEABAUGEhMhMUFRcSIyYaHBFkKB0ZGx8P/aAAwDAQACEQMRAD8Avy44hlhTrqw22kEqUo6BIG5JPkMSxz67RlFPzFquWnDParOaN4QVlmqXDKcKKLS19CCsf8qh6A6e+OfaK573LDTanDJllVV0q8r3ZVIuGqR1fMpdJSdHCCOinN0j7e+FjymydjRKdSbGsikpbSlG5O3/AHfeX5nU6knck6DFdg+DovkquLlWllHE8yeg+f4FBPvluEpEqNC657/4yr4ecm3ZxH1OghzxfptpQERI7X8QrqdPXGNpucXGLltU0SbZ4jazW0tHX4C6IiJcd37HUEj8YoHNtTKOzwuHVPj79rTfhkfCudxEbUOqQQd9Pc4HlaoGRt2JVAcptRsOe54WZZkd6yFHpzakgD3098ahYWuVVDQ/YrKD9wJnvGqfb8UAHH584npWw4eu0+iVO+6Vl3xO2zHy1uKa4GafdcBwqos5w7AOE6lgk+epT68uK8MvNPxmnmHEvMuJCm3EKCkqSRqCCNiCPPHmbzdyWcozkq1rpitVSkzGyqHNbT4HU+S0H6Vp22/9Bw8XZkcQ1wuzLg4V8yqq5U69a0X42zalJXq5NpeuhZJO5LWo0/idPpxI5ryszgyG77D3Nrau+U8weh/cDgQRI3sGXi54VCCKXK6Ku5fnbOcTt2znO/8A0SfFtymcx17llpGqgPTUjDj5WOIOUmYFPpLgjXQ5ES627r43I6R40I9D16fuGEfzPZeyq7afiRtec0W03O/GuSj82wdbdb8ZB89FEjb0xvrIzGk2pmnSrgcdUttl3lkoB2UyrZadPbf8DFFhGHuX+W0bASUyY6kKJg96XPK0XJmt9MrkFuIQw2XNup8IwFbruVaWXkttMgadCCcEfNuPTbbzPkiK87+jVRsTqctlIKVNubkD2J/0RgBVFDVQUpTTEksjdTjpG4xc4TYOvBu5AhB3yf8AcfmgTIUUmiMxcs27+CG42Koy3JqFqym3YLytebuVfRr9gVD2AwvOWt5u2f2qXDle0FK4UhVwijzgFbPMSUlBSftqdcMAqN/TfCVV0yGBDl3O+huMwvZXw6Oqzr67n8jC85VWw/fnakZD2tAaL/wtwGsSuTfu2YyCeY+6ikY5x1yzVlDECB4C8Nn3lEx6SFe9MWtW3R1jfVTu0l4a7lv6wbaz8yqp6p2gridZ2X6FmXT2U6uVelq8TrQA3UtG6gPMFQG+mJe2Xf8ASL5s1qp0p35qfDLhuHR2M4P8kLT5aH/ePUSpIUnQjUemJh8SXZs2fmVf8/MvJevKyfzNkEuTPhGeamVNZ3JeZGnKonqpPXqQTjE8tZmdwF4hSdbSjvHMHqP1zo24tw8J4EUn9MvWz7iymo9tX27PgTqQ4tMCfGY735SuiFdenTTTyGOIrGV1DSJLCqndb7Z1aamIDEZJHQqGg5vyDga3Fw28bVhS1wqrlHAzAjtkhFSt2sIQHR5HkXoQftjrqJw5cYt81BESDkuxaCVnRU24K0Fpb+/I3qT7Y1b6kygptSi88lKiSWxIEkyRygE8tUUDsbieA71mM2M0mZxlVytTQ0w0jkQlIIQ2PpabR1JJ6Abk4oP2bHDhW6O9WuITMKlLplxV9hMeg06Sn5lPgjdIUPJayedX4HljvOHvs16VbF7Uy/c86/8A3DuyIoOwoAaDdPgL66ts7gqH7lan2xVaJEjQaezFiMIjx2khLbaBoEgYyzMmZTjWi2t0bK3b8qfk+v8AW/jNMGWdn4lGVGv/2SAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICA=';
                    // A documentation reference can be found at
                    // https://github.com/bpampuch/pdfmake#getting-started
                    // Set page margins [left,top,right,bottom] or [horizontal,vertical]
                    // or one number for equal spread
                    // It's important to create enough space at the top for a header !!!
                    doc.pageMargins = [60,60,60,30];
                    // Set the font size fot the entire document
                    doc.defaultStyle.fontSize = 12;
                    // Set the fontsize for the table header
                    doc.styles.tableHeader.fontSize = 13;
                    //doc.styles.tableBodyOdd.fillColor = "yellow";
                    {# doc.styles.tableBodyOdd.alignment = function (rowIndex, node, columnIndex) {
                                                    //return (rowIndex >= 0) ? 'center' : null;
                                                    return 'center';
                                                }; #}
                    doc.styles.tableBodyEven.alignment = 'center';
                    doc.styles.tableBodyOdd.alignment = 'center'; 
                    {# doc.styles.tableHeader.fillColor = "#6c757d"; #}
                    console.log(doc);
                    var objTable = {};
                    //objTable['heights'] = (function(i) { return 100; });
                    //objTable['widths'] = ['*', 'auto', '*', 'auto', 'auto', 'auto'];
                    //objTable['widths']   = (function(i) { return ['*', 'auto', '*', 'auto', 'auto', 'auto']; });
                    //doc.content[1].table = objTable; 
                    doc.content[1].table.widths = ['auto', '*']; 
                    //doc.content[1].table.heights = (function(i) { return 100; }); 
                    {# doc.content[1].layout = {
                                                fillColor: function (rowIndex, node, columnIndex) {
                                                    return (rowIndex % 2 === 0) ? '#CCCCCC' : null;
                                                }
                                            };  #}
                        
                    // Create a header object with 3 columns
                    // Left side: Logo
                    // Middle: brandname
                    // Right side: A document title
                    /*doc['header']=(function() {
                        return {
                            columns: [
                                {
                                    //image: logo,
                                    "width": 24
                                },
                                {
                                    alignment: 'left',
                                    italics: true,
                                    text: 'dataTables',
                                    fontSize: 18,
                                    margin: [10,0]
                                },
                                {
                                    alignment: 'right',
                                    fontSize: 14,
                                    text: 'Custom PDF export with dataTables'
                                }
                            ],
                            margin: 20
                        }
                    });*/
                    // Create a footer object with 2 columns
                    // Left side: report creation date
                    // Right side: current page and total pages
                    doc['footer']=(function(page, pages) {
                        return {
                            columns: [
                                {
                                    alignment: 'left',
                                    text: ['Crée le : ', { text: jsDate.toString() }]
                                },
                                {
                                    alignment: 'center',
                                    text: ['{{app.user.enterprise.socialReason}} {% if app.user.enterprise.niu is not empty %}- NIU : {{app.user.enterprise.niu}} {% endif %} {% if app.user.enterprise.rccm is not empty %}- RCCM : {{app.user.enterprise.rccm}}{% endif %}']
                                },
                                {
                                    alignment: 'right',
                                    text: ['page ', { text: page.toString() },	' de ',	{ text: pages.toString() }]
                                }
                            ],
                            margin: [10, 0]
                        }
                    });
                    // Change dataTable layout (Table styling)
                    // To use predefined layouts uncomment the line below and comment the custom lines below
                    // doc.content[0].layout = 'lightHorizontalLines'; // noBorders , headerLineOnly
                    var objLayout = {};
                    objLayout['hLineWidth']   = (function(i) { return .5; });
                    objLayout['vLineWidth']   = (function(i) { return .5; });
                    objLayout['hLineColor']   = (function(i) { return '#ccc'; });
                    objLayout['vLineColor']   = (function(i) { return '#ccc'; });
                    objLayout['paddingLeft']  = (function(i) { return 4; });
                    objLayout['paddingRight'] = (function(i) { return 4; });
                    doc.content[0].layout = objLayout;
                } 
            },
            {
                //text: 'Exporter Disponibilité',
                extend: 'excel',
                filename: FileNameGridBill,
                exportOptions: {
                    //columns: [ 0, 1, 4 ],
                    //columns: ':visible'
                    search: 'applied',
                    order: 'applied'
                },
            }
        ] 
    });

    historicFuelBillTable.buttons().container().appendTo('#historic-fuelBill-dataTable_wrapper .col-md-6:eq(0)');

    $('.buttons-pdf').children('span').prepend('<i class="mdi mdi-download mr-2"></i>');
    $('.buttons-pdf').removeClass('btn-secondary').addClass('btn-outline-danger')
    $('.buttons-excel').removeClass('btn-secondary').addClass('btn-outline-success')
</script>

<script>

    // w-load Chart Grid variable
    var w_loadChartGrid;

    // w-load Chart Genset variable
    var w_loadChartGenset;

    // w-load Chart Solar variable
    var w_loadChartSolar;

    // w-load Chart Batt variable
    var w_loadChartBatt;

    // w-co2 Chart variable
    var w_co2Chart;

    // w-loadChart Chart variable
    var w_loadChart;
    
    // load Chart variable
    var loadChart;
    //const promise = function(){
    new Promise(function(resolve, reject){
        //$('#load-chart-loader').removeClass('d-none')
        setTimeout(function(){
            /*var defs1 = {
                label: "label",
                value: 65,
                min: 0,
                max: 100,
                decimals: 0,
                gaugeWidthScale: 0.6,
                pointer: true,
                pointerOptions: {
                    toplength: 10,
                    bottomlength: 10,
                    bottomwidth: 2
                },
                counter: true
            }

            var jg2 = new JustGage({
                id: "fuel_level",
                defaults: defs1
            });*/
            
            var loadGrid_options = {
                chart: {
                    id: 'kW_Grid',
                    group: 'loadChart',
                    type: 'area',
                    height: 30,
                    sparkline: {
                        enabled: true
                    },
                    animations:{
                        enabled:false
                    },
                },
                stroke: {
                    curve: 'smooth',
                    width: 2,
                },
                series: [{
                    {# name: 'Énergie Active', #}
                    name: 'Puissance Active',
                    {# data: {{ gridData['kWh'] | json_encode | raw }} #}
                    data: {{ gridData['kW'] | json_encode | raw }}
                    {# data: [28, 40, 36, 52, 38, 60, 38, 28, 40, 36, 52, 38, 60, 38, 28, 40, 36, 52, 38, 60, 38, 28, 40, 36, 52, 38, 60, 38, 27, 51, 80] #}
                }],
                {# labels: {{ gridData['date'] | json_encode | raw }}, #}
                labels: {{ gridData['dateP'] | json_encode | raw }},
                {# labels: ['1', '2', '3', '4', '5', '6', '7'], #}
                xaxis: {
                    type: 'datetime',
                    //categories: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016],
                    {# categories: {{ gridData['dateP'] | json_encode | raw }}, #}
                    categories: [],
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('MMM YYYY').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                yaxis: {
                    min: 0
                },
                colors: ['#53e21b'],
                tooltip: {
                    theme: "dark",
                    //followCursor: true,
                    y: {
                        formatter: function (y) {
                            //console.log(y)
                            if (typeof y !== "undefined") {
                                {# return y.toFixed(2) + " kWh" #}
                                return y.toFixed(2) + " kW"
                            }
                            return y;
                        }
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            return moment(new Date(val)).format("DD MMM YYYY HH:mm")
                        }
                    }
                },
                /*tooltip: {
                    x: {
                    show: false,
                    }
                },*/
                fill: {
                    type:"gradient",
                    gradient: {
                        type: "vertical",
                        shadeIntensity: 1,
                        inverseColors: !1,
                        opacityFrom: .40,
                        opacityTo: .05,
                        stops: [45, 100]
                    }
                },
                noData: {
                    text: 'Data not yet available',
                    align: 'center',
                    verticalAlign: 'middle',
                    offsetX: 0,
                    offsetY: 0,
                    style: {
                        color: undefined,
                        fontSize: '10px',
                        fontFamily: 'Nunito, sans-serif'
                    }
                }
            }
            // w-conso Chart variable
            w_loadChartGrid = new ApexCharts(document.querySelector("#w-load-chart-grid"), loadGrid_options);
            w_loadChartGrid.render()


            var loadGenset_options = {
                chart: {
                    id: 'kW_Genset',
                    group: 'loadChart',
                    type: 'area',
                    height: 30,
                    sparkline: {
                        enabled: true
                    },
                    animations:{
                        enabled:false
                    },
                },
                stroke: {
                    curve: 'smooth',
                    width: 2,
                },
                series: [{
                    {# name: 'Énergie Active', #}
                    name: 'Puissance Active',
                    {# data: {% if hasgensetMod %}{{ gensetData['dayBydayTEPData']['TEP'] | json_encode | raw }}{% else %}[]{% endif %} #}
                    data: {% if hasgensetMod %}{{ gensetData['loadProfileData']['kW'] | json_encode | raw }}{% else %}[]{% endif %}
                    {# data: [28, 40, 36, 52, 38, 60, 38, 28, 40, 36, 52, 38, 60, 38, 28, 40, 36, 52, 38, 60, 38, 28, 40, 36, 52, 38, 60, 38, 27, 51, 80] #}
                }],
                {# labels: {% if hasgensetMod %}{{ gensetData['dayBydayTEPData']['date'] | json_encode | raw }}{% else %}[]{% endif %}, #}
                labels: {% if hasgensetMod %}{{ gensetData['loadProfileData']['date'] | json_encode | raw }}{% else %}[]{% endif %},
                {# labels: ['1', '2', '3', '4', '5', '6', '7'], #}
                xaxis: {
                    type: 'datetime',
                    //categories: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016],
                    categories: [],
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('MMM YYYY').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                yaxis: {
                    min: 0
                },
                colors: ['#e26b1b'],
                tooltip: {
                    theme: "dark",
                    //followCursor: true,
                    y: {
                        formatter: function (y) {
                            //console.log(y)
                            if (typeof y !== "undefined") {
                                {# return y.toFixed(2) + " kWh" #}
                                return y.toFixed(2) + " kW"
                            }
                            return y;
                        }
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            {# return moment(new Date(val)).format("DD MMM YYYY") #}
                            return moment(new Date(val)).format("DD MMM YYYY HH:mm")
                        }
                    }
                },
                /*tooltip: {
                    x: {
                    show: false,
                    }
                },*/
                fill: {
                    type:"gradient",
                    gradient: {
                        type: "vertical",
                        shadeIntensity: 1,
                        inverseColors: !1,
                        opacityFrom: .40,
                        opacityTo: .05,
                        stops: [45, 100]
                    }
                },
                noData: {
                    text: 'Data not yet available',
                    align: 'center',
                    verticalAlign: 'middle',
                    offsetX: 0,
                    offsetY: 0,
                    style: {
                        color: undefined,
                        fontSize: '10px',
                        fontFamily: 'Nunito, sans-serif'
                    }
                }
            }
            // w-conso Chart variable
            w_loadChartGenset = new ApexCharts(document.querySelector("#w-load-chart-genset"), loadGenset_options);
            w_loadChartGenset.render()

            var loadSolar_options = {
                chart: {
                    id: 'kW_Solar',
                    group: 'loadChart',
                    type: 'area',
                    height: 30,
                    sparkline: {
                        enabled: true
                    },
                    animations:{
                        enabled:false
                    },
                },
                stroke: {
                    curve: 'smooth',
                    width: 2,
                },
                series: [{
                    name: 'Énergie Active',
                    {# data: {{ dayBydayConsoData['kWh'] | json_encode | raw }} #}
                    {# data: [28, 40, 36, 52, 38, 60, 38, 28, 40, 36, 52, 38, 60, 38, 28, 40, 36, 52, 38, 60, 38, 28, 40, 36, 52, 38, 60, 38, 27, 51, 80] #}
                    data: []
                }],
                {# labels: {{ dayBydayConsoData['dateConso'] | json_encode | raw }}, #}
                {# labels: ['1', '2', '3', '4', '5', '6', '7'], #}
                labels: [],
                xaxis: {
                    type: 'datetime',
                    //categories: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016],
                    categories: [],
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('MMM YYYY').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                yaxis: {
                    min: 0
                },
                colors: ['#ffc719'],
                tooltip: {
                    theme: "dark",
                    //followCursor: true,
                    y: {
                        formatter: function (y) {
                            //console.log(y)
                            if (typeof y !== "undefined") {
                                return y.toFixed(2) + " kWh"
                            }
                            return y;
                        }
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            return moment(new Date(val)).format("DD MMM YYYY")
                        }
                    }
                },
                /*tooltip: {
                    x: {
                    show: false,
                    }
                },*/
                fill: {
                    type:"gradient",
                    gradient: {
                        type: "vertical",
                        shadeIntensity: 1,
                        inverseColors: !1,
                        opacityFrom: .40,
                        opacityTo: .05,
                        stops: [45, 100]
                    }
                },
                noData: {
                    text: 'Data not yet available',
                    align: 'center',
                    verticalAlign: 'middle',
                    offsetX: 0,
                    offsetY: 0,
                    style: {
                        color: undefined,
                        fontSize: '10px',
                        fontFamily: 'Nunito, sans-serif'
                    }
                }
            }
            // w-conso Chart variable
            w_loadChartSolar = new ApexCharts(document.querySelector("#w-load-chart-solar"), loadSolar_options);
            w_loadChartSolar.render()

            var loadBatt_options = {
                chart: {
                    id: 'kW_Batt',
                    group: 'loadChart',
                    type: 'area',
                    height: 30,
                    sparkline: {
                        enabled: true
                    },
                    animations:{
                        enabled:false
                    },
                },
                stroke: {
                    curve: 'smooth',
                    width: 2,
                },
                series: [{
                    name: 'Énergie Active',
                    {# data: {{ dayBydayConsoData['kWh'] | json_encode | raw }} #}
                    {# data: [28, 40, 36, 52, 38, 60, 38, 28, 40, 36, 52, 38, 60, 38, 28, 40, 36, 52, 38, 60, 38, 28, 40, 36, 52, 38, 60, 38, 27, 51, 80] #}
                    data: []
                }],
                {# labels: {{ dayBydayConsoData['dateConso'] | json_encode | raw }}, #}
                {# labels: ['1', '2', '3', '4', '5', '6', '7'], #}
                labels: [],
                xaxis: {
                    type: 'datetime',
                    //categories: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016],
                    categories: [],
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('MMM YYYY').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                yaxis: {
                    min: 0
                },
                colors: ['#1b55e2'],
                tooltip: {
                    theme: "dark",
                    //followCursor: true,
                    y: {
                        formatter: function (y) {
                            //console.log(y)
                            if (typeof y !== "undefined") {
                                return y.toFixed(2) + " kWh"
                            }
                            return y;
                        }
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            return moment(new Date(val)).format("DD MMM YYYY")
                        }
                    }
                },
                /*tooltip: {
                    x: {
                    show: false,
                    }
                },*/
                fill: {
                    type:"gradient",
                    gradient: {
                        type: "vertical",
                        shadeIntensity: 1,
                        inverseColors: !1,
                        opacityFrom: .40,
                        opacityTo: .05,
                        stops: [45, 100]
                    }
                },
                noData: {
                    text: 'Data not yet available',
                    align: 'center',
                    verticalAlign: 'middle',
                    offsetX: 0,
                    offsetY: 0,
                    style: {
                        color: undefined,
                        fontSize: '10px',
                        fontFamily: 'Nunito, sans-serif'
                    }
                }
            }
            // w-conso Chart variable
            w_loadChartBatt = new ApexCharts(document.querySelector("#w-load-chart-batt"), loadBatt_options);
            w_loadChartBatt.render()

            var loadChart_options = {
                chart: {
                    id: 'kW_Load',
                    group: 'loadChart',
                    type: 'area',
                    height: 30,
                    sparkline: {
                        enabled: true
                    },
                    animations:{
                        enabled:false
                    },
                },
                stroke: {
                    curve: 'smooth',
                    width: 2,
                },
                series: [{
                    {# name: 'Énergie Active', #}
                    name: 'Puissance Active',
                    {# data: {{ loadSiteData['kWh'] | json_encode | raw }} #}
                    data: {{ loadSiteData['kW'] | json_encode | raw }}
                    {# data: [28, 40, 36, 52, 38, 60, 38, 28, 40, 36, 52, 38, 60, 38, 28, 40, 36, 52, 38, 60, 38, 28, 40, 36, 52, 38, 60, 38, 27, 51, 80] #}
                }],
                {# labels: {{ loadSiteData['date'] | json_encode | raw }}, #}
                labels: {{ loadSiteData['dateP'] | json_encode | raw }},
                {# labels: ['1', '2', '3', '4', '5', '6', '7'], #}
                xaxis: {
                    type: 'datetime',
                    //categories: [2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016],
                    categories: [],
                    labels: {
                        datetimeFormatter: {
                            year: 'yyyy',
                            month: 'MMM \'yy',
                            day: 'dd MMM',
                            hour: 'HH:mm'
                        }
                    },
                    title: {
                        text: moment().format('DD MMMM').toString(),
                        style: {
                            fontSize: '14px',
                            fontWeight: 'bold',
                            fontFamily: undefined,
                            color: '#444'
                        },
                    }
                },
                yaxis: {
                    min: 0
                },
                colors: ['#7030A0'],
                tooltip: {
                    theme: "dark",
                    //followCursor: true,
                    y: {
                        formatter: function (y) {
                            //console.log(y)
                            if (typeof y !== "undefined") {
                                {# return y.toFixed(2) + " kWh" #}
                                return y.toFixed(2) + " kW"
                            }
                            return y;
                        }
                    },
                    x: {
                        formatter: function (val, timestamp) {
                            {# return moment(new Date(val)).format("DD MMM YYYY") #}
                            return moment(new Date(val)).format("DD MMM YYYY HH:mm")
                        }
                    }
                },
                /*tooltip: {
                    x: {
                    show: false,
                    }
                },*/
                fill: {
                    type:"gradient",
                    gradient: {
                        type: "vertical",
                        shadeIntensity: 1,
                        inverseColors: !1,
                        opacityFrom: .40,
                        opacityTo: .05,
                        stops: [45, 100]
                    }
                },
                noData: {
                    text: 'Data not yet available',
                    align: 'center',
                    verticalAlign: 'middle',
                    offsetX: 0,
                    offsetY: 0,
                    style: {
                        color: undefined,
                        fontSize: '10px',
                        fontFamily: 'Nunito, sans-serif'
                    }
                }
            }
            // w-conso Chart variable
            w_loadChart = new ApexCharts(document.querySelector("#w-load-chart"), loadChart_options);
            w_loadChart.render()            
            
        }, 500)
        resolve('load chart render')

    }).then(function(elem){
        //$('#load-chart-loader').addClass('d-none')
    });
            
    //})

    
    function progress(prefixSelector, progValue, posLogique, isTime) {
        
        var id = '#' + prefixSelector;
        var progressSelectorValue = $(id + 'value');
        var progressSelectorColor = $(id + 'color');
        var upSelectorIcon        = $(id + 'up-icon');
        var downSelectorIcon      = $(id + 'down-icon');
        var greenColor            = 'text-success';
        var redColor              = 'text-danger';
        
        if (!isTime) {//On teste s'il s'agit d'une progression numérique 
            var val = progValue !== 'INF' ? String(parseFloat(progValue).toFixed(2)) : progValue;
            progressSelectorValue.html(progValue === null ? 0 : (progValue > 0 || progValue === 'INF') ? ('+' + val) : val);
        }
        else {//s'il s'agit d'une progression de date
            var diff = new Date(Math.abs(progValue));
            var $dat = new moment(diff).subtract(timeZoneOffset, 'hours');
            var str = $dat.format('HH:mm:ss').toString()
            progressSelectorValue.html(progValue === null ? 0 : progValue > 0 ? '+' + str : '-' + str);
        }

        if (posLogique) {// Logique positive
            if (progValue > 0 || progValue === 'INF') {//Si la valeur de progression est positive
                //On met la valeur et l'îcone en vert
                progressSelectorColor.removeClass(redColor).addClass(greenColor);

                //On affiche l'îcone svg arrow-up
                upSelectorIcon.removeClass('d-none');

                //On masque l'îcone svg arrow-down
                downSelectorIcon.addClass('d-none');

                /*if (selectorIcon.hasClass(oldClass)) {
                    // it has class
                } else {
                    // it doesn't have specified class
                }*/
            }
            else {//Si la valeur de progression est négative
                //On met la valeur et l'îcone en rouge
                progressSelectorColor.removeClass(greenColor).addClass(redColor);

                //On affiche l'îcone svg arrow-down
                downSelectorIcon.removeClass('d-none');

                //On masque l'îcone svg arrow-up
                upSelectorIcon.addClass('d-none');
            }
        }
        else {// Logique négative
            if (progValue > 0 || progValue === 'INF') {//Si la valeur de progression est positive
                
                //On met la valeur et l'îcone en rouge
                progressSelectorColor.removeClass(greenColor).addClass(redColor);
                
                //On affiche l'îcone svg arrow-up
                upSelectorIcon.removeClass('d-none');

                //On masque l'îcone svg arrow-down
                downSelectorIcon.addClass('d-none');

            }
            else {//Si la valeur de progression est négative
                
                //On met la valeur et l'îcone en vert
                progressSelectorColor.removeClass(redColor).addClass(greenColor);
                
                //On affiche l'îcone svg arrow-down
                downSelectorIcon.removeClass('d-none');

                //On masque l'îcone svg arrow-up
                upSelectorIcon.addClass('d-none');
                
            }
        }
    }

    //setTimeout(getClimateData, 100);

    function getClimateData(){
        // My key 4e7cd8803316af415207236c1b888ba3
        var key = "4532cfe7e35c05d1290279dd42fe18bd"
        
        var url = "http://api.openweathermap.org/data/2.5/onecall?lat={{site.latitude}}&lon={{site.longitude}}&units=metric&exclude=hourly,daily&appid=" + key;
        $.getJSON(url, function (result) {//{'selectedDate': $date},
            console.log(result)
            if( Object.keys(result).length > 0 ){ 
                //Température en °C
                $('#w-temp').text(String(parseFloat(result['current']['temp']).toFixed(2)))
          
                //Humidité relative
                $('#w-hum').text(String(parseFloat(result['current']['humidity']).toFixed(2)))

                //Display weather icon
                var iconcode = result['current']['weather'][0]['icon'];
                var iconurl = "http://openweathermap.org/img/w/" + iconcode + ".png";
                $('#wicon').attr('src', iconurl);
            }        
            else{
                //$('.spin').addClass('d-none');
                
            }
        }).fail(function() { 
            
            console.log('FAIL to get Climate Data')
            
        });
                 
    }
    
    setInterval(function () {
        $.getJSON("{{ path('site_pro_overview_update_data', {'slug': site.slug}) }}", function (result) {//{'selectedDate': $date},
            
            if( Object.keys(result).length > 0 ){
                console.log(result)

                {# $('#last_update').text(String( moment( new Date(result['gensetData']['last_update']) ).format("DD MMM YYYY HH:mm:ss")) ) #}
                $('#last_update').text(result['gensetData']['last_update']);
                
                //++++ Mise à jour des données de la card GRID du mois cours
                //Valeur de la puissance active en cours du GRID
                if(result['gensetData']['CGCR']['CR']){
                    $('#grid-kW').text(String(parseFloat(result['gensetData']['Power']).toFixed(2)))

                }else{
                    $('#grid-kW').text(String(parseFloat(0.0)));

                }
                //Valeur de la fourniture d'énergie active provenant du GRID pour le mois en cours
                $('#w-grid-fourniture').text(String(parseFloat(result['gridData']['totalKWh']).toFixed(2)))
                //Pourcentage de contribution d'énergie active du GRID pour le mois en cours
                $('#w-grid-contrib').text(String(parseFloat(result['gridData']['contrib']).toFixed(2)))
                //Facteur de puissance d'énergie provenant du GRID pour le mois en cours
                $('#w-grid-fp').text(String(parseFloat(result['gridData']['FP']).toFixed(2)))
                //Puissance max provenant du GRID pour le mois en cours
                $('#w-grid-pmax').text(String(parseFloat(result['gridData']['Pmax']).toFixed(2)))
                {# //MAJ de la courbe d'évolution de la fourniture en kWh jour après jour provenant du GRID
                displayNewData(w_loadChartGrid, Object.values(result['gridData']['date']), Object.values(result['gridData']['kWh']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 1, 'day'); #}
                //MAJ de la courbe d'évolution de la courbe de charge en kW du GRID
                displayNewData(w_loadChartGrid, Object.values(result['gridData']['dateP']), Object.values(result['gridData']['kW']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 1, 'day');
                
                {% if hasgensetMod %}
                    //++++ Mise à jour des données de la card GENSET du mois cours
                    var lastGridState = srcState["grid"];
                    var lastGensetState = srcState["genset"];
                    //Valeur de la puissance active en cours du GENSET
                    if(result['gensetData']['CGCR']['CG']){
                        $('#genset-kW').text(String(parseFloat(result['gensetData']['Power']).toFixed(2)))
                        srcState["grid"]   = false;
                        srcState["genset"] = true;
                        if(lastGensetState != srcState["genset"]) addSnake("genset");
                    }else{
                        $('#genset-kW').text(String(parseFloat(0.0)));
                        srcState["grid"]   = true;
                        srcState["genset"] = false;
                        if(lastGridState != srcState["grid"]) addSnake("grid");
                    }
                    //Valeur de la fourniture d'énergie active provenant du GENSET pour le mois en cours
                    $('#w-genset-fourniture').text(String(parseFloat(result['gensetData']['currentTEP']).toFixed(2)))
                    //Pourcentage de contribution d'énergie active du GENSET pour le mois en cours
                    $('#w-genset-contrib').text(String(parseFloat(result['contriGensetKWh']).toFixed(2)))
                    //Consommation de Fuel du GENSET pour le mois en cours
                    $('#w-genset-conso-fuel').text(String(parseFloat(result['gensetData']['currentConsoFuel']).toFixed(2)))
                    //Charge max du GENSET pour le mois en cours
                    $('#w-genset-load-max').text(String(parseFloat(result['gensetData']['loadMax']).toFixed(2)))
                    {# //MAJ de la courbe d'évolution de la fourniture en kWh jour après jour provenant du GENSET
                    displayNewData(w_loadChartGenset, Object.values(result['gensetData']['dayBydayTEPData']['date']), Object.values(result['gensetData']['dayBydayTEPData']['TEP']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 1, 'day'); #}
                    //MAJ de la courbe d'évolution de la courbe de charge en kW du GENSET
                    displayNewData(w_loadChartGenset, Object.values(result['gensetData']['loadProfileData']['date']), Object.values(result['gensetData']['loadProfileData']['kW']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 1, 'day');
                {% endif %}
                             
                //++++ Mise à jour des données de la card LOAD du mois cours
                //Valeur de la puissance active en cours de la charge
                $('#load-kW').text(String(parseFloat(result['gensetData']['Power']).toFixed(2)))

                //Valeur de la Consommation d'énergie active de la charge pour le mois en cours
                $('#w-load-conso').text(String(parseFloat(result['loadSiteData']['totalKWh']).toFixed(2)))
                
                //Facteur de puissance de la charge pour le mois en cours
                $('#w-load-fp').text(String(parseFloat(result['loadSiteData']['FP']).toFixed(2)))
                
                //Puissance max de la charge pour le mois en cours
                $('#w-load-pmax').text(String(parseFloat(result['loadSiteData']['Pmax']).toFixed(2)))
                
                {# //MAJ de la courbe d'évolution de la fourniture en kWh jour après jour de la charge
                displayNewData(w_loadChart, Object.values(result['loadSiteData']['date']), Object.values(result['loadSiteData']['kWh']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 1, 'day'); #}
                //MAJ de la courbe d'évolution de la courbe de charge en kW de l'installation
                displayNewData(w_loadChart, Object.values(result['loadSiteData']['dateP']), Object.values(result['loadSiteData']['kW']), [moment().format("DD MMM YYYY"), moment().format("DD MMM YYYY")], 1, 'day');
                                                
                //++++ Mise à jour des données de la card d'émission de carbone du mois cours
                //Empreinte carbonne pour le mois en cours
                $('#w-emission-value').text(String(parseFloat(result['kgCO2']).toFixed(2)))
                               
                
            }        
            else{
                //$('.spin').addClass('d-none');
                
            }
        }).fail(function() { 
            
            console.log('FAIL to get overview Data')
            
        });
    }, 10000); 

</script>

<!-- Script de gestion du sélecteur de date -->
<script>

    var _url = "{{ path('site_pro_histo_update', {'slug':site.slug}) }}";
    
    {# var conso_options = {
      chart: {
        fontFamily: 'Nunito, sans-serif',

        height: 350,
        type: 'bar',
        toolbar: {
            show: true,
        },

        stacked: false,

        dropShadow: {
            enabled: true,
            top: 1,
            left: 1,
            blur: 2,
            color: '#acb0c3',
            opacity: 0.7,
        }
      },
      //colors: ['#5c1ac3', '#e7515a'],
      plotOptions: {
          bar: {
              horizontal: false,
              columnWidth: '55%',
              //endingShape: 'rounded'  
          },
      },
      dataLabels: {
          enabled: false
      },
      legend: {
            position: 'bottom',
            horizontalAlign: 'center',
            fontSize: '14px',
            markers: {
              width: 10,
              height: 10,
            },
            itemMargin: {
              horizontal: 0,
              vertical: 8
            }
      },
      stroke: {
          show: true,
          width: 2,
          colors: ['transparent']
      },
      series: [{
        name: 'Énergie Active',
        data: []
      }],
      xaxis: {
        type: 'datetime',
        categories: [],
        labels: {
        datetimeFormatter: {
            year: 'yyyy',
            month: 'MMM \'yy',
            day: 'dd MMM',
            hour: 'HH:mm'
        }
        },
      },
      yaxis: [
        {
            axisTicks: {
                show: true,
            },
            axisBorder: {
                show: true,
                color: '#5c1ac3'
            },
            labels: {
                style: {
                    color: '#5c1ac3',
                }
            },
            title: {
                text: "kWh"
            },
        }
      ],
      fill: {
        type: 'gradient',
        gradient: {
          shade: 'light',
          type: 'vertical',
          shadeIntensity: 0.3,
          inverseColors: false,
          opacityFrom: 1,
          opacityTo: 0.8,
          stops: [0, 100]
        }
      },
      tooltip: {
        theme: "dark",
        //followCursor: true,
        y: {
            formatter: function (y) {
                //console.log(y)
                if (typeof y !== "undefined") {
                    return y.toFixed(2) + " kWh"
                }
                return y;
            }
        },
        x: {
            formatter: function (val, timestamp) {
                return moment(new Date(val)).format("DD MMM YYYY")
            }
        }
      },
    }
    
    var ConsoChart = new ApexCharts(
        document.querySelector("#conso"),
        conso_options
    );
    ConsoChart.render(); #}

    var ContribChart_options = {
        chart: {
            fontFamily: 'Nunito, sans-serif',
            width: 300,
            type: 'pie',
        },
        colors: ["#53e21b","#e26b1b","#FFC737","#1b55e2"],
        {# series: [55, 45, 13, 5], #}
        series: [0, 0, 0, 0],
        labels: ['From Grid ', 'From Genset ', 'From Solar ', 'From Battery '],
        legend: {
            position: 'bottom',
            horizontalAlign: 'center', 
            //offsetY: 40
        },
        responsive: [{
          breakpoint: 480,
          options: {
            /*chart: {
              width: 300
            },*/
            legend: {
              position: 'bottom',
             // show: false,
            }
          }
        }],
        tooltip: {
            followCursor: true,
            shared: false,
            theme: "dark",
            //followCursor: true,
            y: {
                formatter: function (y) {
                    //console.log(y)
                    if (typeof y !== "undefined") {
                        return y.toFixed(2) + " kWh"
                    }
                    return y;
                }
            },
            /*x: {
                formatter: function (val, timestamp) {
                    return moment(new Date(val)).format("DD MMM YYYY")
                }
            }*/
        }
    };

    var ContribChart = new ApexCharts(document.querySelector("#contri-source"), ContribChart_options);
    ContribChart.render();

    var MixedConsoChart_options = {
        series: [{
            name: 'From Grid ',
            {# data: [44, 55, 41, 67, 22, 43] #}
            data: []
            }, {
            name: 'From Genset ',
            {# data: [13, 23, 20, 8, 13, 27] #}
            data: []
            }, {
            name: 'From Solar ',
            {# data: [11, 17, 15, 15, 21, 14] #}
            data: []
            }, {
            name: 'From Battery ',
            {# data: [21, 7, 25, 13, 22, 8] #}
            data: []
        }],
        chart: {
            fontFamily: 'Nunito, sans-serif',
            type: 'bar',
            height: 350,
            stacked: true,
            toolbar: {
                show: true
            },
            zoom: {
                enabled: true
            }
        },
        colors: ["#53e21b","#e26b1b","#FFC737","#1b55e2"],
        responsive: [{
          breakpoint: 480,
          options: {
            legend: {
              position: 'bottom',
              offsetX: -10,
              offsetY: 0
            }
          }
        }],
        plotOptions: {
          bar: {
            horizontal: false,
            borderRadius: 10
          },
        },
        xaxis: {
            type: 'datetime',
            //categories: [],
            categories: ['01/01/2011 GMT', '01/02/2011 GMT', '01/03/2011 GMT', '01/04/2011 GMT',
                '01/05/2011 GMT', '01/06/2011 GMT'
            ],
            labels: {
                datetimeFormatter: {
                    year: 'yyyy',
                    month: 'MMM \'yy',
                    day: 'dd MMM',
                    hour: 'HH:mm'
                }
            },
        },
        yaxis: [
            {
                axisTicks: {
                    show: true,
                },
                axisBorder: {
                    show: true,
                    color: '#5c1ac3'
                },
                labels: {
                    style: {
                        color: '#5c1ac3',
                    }
                },
                title: {
                    text: "kWh"
                },
            }
        ],
        legend: {
          position: 'bottom',
          //offsetY: 1
        },
        fill: {
          opacity: 1
        },
        dataLabels: {
            enabled: true,
            offsetY: 40,
            style: {
                fontSize: '12px',
                colors: ["#304758"]
            },
            formatter: function(value, { seriesIndex, dataPointIndex, w}) {
                //return w.globals.stackedSeriesTotals[dataPointIndex];
                if (seriesIndex === ((w.config.series.length) - parseInt(1)))
                    return w.globals.stackedSeriesTotals[dataPointIndex];
                return "";//value + " kWh";
                /*formatter: function(value, { seriesIndex, dataPointIndex, w}) {
                    let indices = w.config.series.map((item, i) => i);
                    console.log("indices = " + indices);
                    indices = indices.filter(i => !w.globals.collapsedSeriesIndices.includes(i) && _.get(w.config.series, `${i}.data.${dataPointIndex}`) > 0);
                    console.log("indices = " + indices);
                    if (seriesIndex == _.max(indices))
                        return w.globals.stackedSeriesTotals[dataPointIndex];
                    return '';
                }*/
            }
        },
        tooltip: {
            followCursor: true,
            shared: true,
            intersect: false,
            /*custom: function({ series, seriesIndex, dataPointIndex, w }) {
                let currentTotal = 0
                series.forEach((s) => {
                    currentTotal += s[dataPointIndex]
                })
                return '<div class="custom-tooltip">' +
                '<span><b>Total: </b>' + currentTotal + '</span>' +
                '</div>'
            },*/
            theme: "dark",
            //followCursor: true,
            y: {
                formatter: function (y) {
                    //console.log(y)
                    if (typeof y !== "undefined") {
                        return y.toFixed(2) + " kWh"
                    }
                    return y;
                }
            },
            x: {
                formatter: function (val, timestamp) {
                    return moment(new Date(val)).format("DD MMM YYYY")
                }
            }
        }
        /*tooltip: {
            shared: true,
            intersect: false,
        }*/
    };

    var MixedConsoChart = new ApexCharts(document.querySelector("#conso"), MixedConsoChart_options);
    MixedConsoChart.render();

    var start = moment().subtract(1, 'days');
    var end = moment();

    function cb(start, end) {
        $('#daterange span').html(start.format('MMMM D, YYYY') + ' - ' + end.format('MMMM D, YYYY'));
    }

    $('#daterange').daterangepicker({
        startDate: start,
        endDate: end,
        maxSpan: {
            "days": 31
        },
        maxDate: moment().endOf('month'),
        ranges: {
            'Today': [moment(), moment()],
            'Yesterday': [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
            'Last 7 Days': [moment().subtract(6, 'days'), moment()],
            'Last 30 Days': [moment().subtract(29, 'days'), moment()],
            'This Month': [moment().startOf('month'), moment().endOf('month')],
            'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
        }
    }, cb);

    var drp = $('#daterange').data('daterangepicker');
    console.log('drp = ' + drp.startDate.format('YYYY-MM-DD'));
    var startDate = drp.startDate.format('YYYY-MM-DD');
    var endDate = drp.endDate.format('YYYY-MM-DD');   

    $('#daterange').on('apply.daterangepicker', function (ev, picker) {
        //console.log(picker.startDate.format('YYYY-MM-DD'));
        //console.log(picker.endDate.format('YYYY-MM-DD'));
    
        startDate = picker.startDate.format('YYYY-MM-DD');
        endDate = picker.endDate.format('YYYY-MM-DD');
        
        console.log('startDate = ' + startDate);
        console.log('endDate = ' + endDate);
        updateHistoGraphs();
        // block of code that runs when the click event triggers

    });

    function displayNewData(chart, label, data, dateopt, multiple, xscale){
        //chart.data.labels = [];
        chart.updateOptions({
            xaxis: {
                categories: []
            },
        });
        chart.updateOptions({
            xaxis: {
                categories: label
            },
        });
        //chart.opts.labels = label;
        /* chart.updateOptions({
            labels: label
            
        }); */
        if(multiple > 1){
            var i = 0;
            chart.opts.series.forEach((dataset) => {
                if( i < multiple){
                    dataset.data = [];
                    console.log(dataset.name);
                    console.log(dataset.data);
                    dataset.data = data[i];
                    console.log(data[i]);
                    console.log(dataset.data);
                    i++;
                }
            });
        }
        else if(multiple == 1){
            chart.updateSeries([{
                data: []
            }]);
        
            chart.updateSeries([{
                data: data
            }]);
        }

        /*if(xscale === 'day'){
            chart.updateOptions({
                xaxis: {
                    title: {
                        //text: moment(dateopt).format('DD MMMM').toString(),
                        text: moment(dateopt[0]).format('DD MMMM YYYY').toString() + ' - ' + moment(dateopt[1]).format('DD MMMM YYYY').toString(),
                    }
                },
            });
        }
        else if( xscale === 'month'){
            chart.updateOptions({
                xaxis: {
                    title: {
                        text: moment(dateopt[0]).format('MMMM YYYY').toString() + ' - ' + moment(dateopt[1]).format('MMMM YYYY').toString(),
                    }
                },
            });
        }*/
        //console.log(chart.options.scales.xAxes[0].scaleLabel.labelString);
        //preloaderChart(id, false);
        //chart.render();
    }            

    function updateDonutChart(chart, label, data) {
        chart.updateOptions({labels: label});
        chart.updateSeries(newDataSeries(chart, data));
    }
    
    function newDataSeries(chart, data) {
        var i = 0;
        return chart.w.globals.series.map(function () {
            return data[i++];
        });
    }

    function updateHistoGraphs(){
        
        $data = JSON.stringify({
            //"selectedDate": $dat, // tabGridId,
            "startDate": startDate + ' 00:00:00', // tabGridId,
            "endDate": endDate + '23:59:59', // tabFuelId,
        });
        
        swal.queue([{
            title: 'Les graphes seront actualisés pour la période :',
            confirmButtonText: 'Confirmer',
            cancelButtonText: 'Annuler',
            text: 'Du ' + startDate + ' Au ' + endDate,
            showCancelButton: true,
            showLoaderOnConfirm: true,
            //confirmButtonClass: 'btn btn-primary',
            //cancelButtonClass: 'btn btn-danger ml-2',
            preConfirm: function () {
                return new Promise(function (resolve) { 
                    
                    $.ajax({
                        type: "POST", // method type
                        contentType: "application/json; charset=utf-8",
                        url: _url, // /Target function that will be return result
                        data: $data, // parameter pass data is parameter name param is value
                        dataType: "json",
                        timeout: 120000, // 64241
                        success: function (result) {
                            // $('.fa-sync').removeClass('fa-spin');
                            console.log(result);
                            
                            swal({
                                type: 'success', 
                                title: 'Les graphes ont été mis !',
                                // html: 'Submitted email: ' + email
                            });

                            setTimeout(function () {
                                resolve()
                            }, 1500);

                            if( Object.keys(result).length > 0 ){
                                $('#total-conso').text(parseFloat(result['totalkWh']).toFixed(2))
                                console.log(Object.values(result['Mixed_Conso']))
                                
                                {# MixedConsoChart.destroy()
                                MixedConsoChart = new ApexCharts(
                                    document.querySelector("#conso"),
                                    MixedConsoChart_options
                                );
                                MixedConsoChart.render() #}
                                displayNewData(MixedConsoChart, result['Mixed_Conso']['date'], Object.values(result['Mixed_Conso']['conso']), [startDate, endDate], 4, 'day');
                                {# MixedConsoChart.toggleSeries('From Grid ')
                                MixedConsoChart.toggleSeries('From Grid ')
                                MixedConsoChart.toggleSeries('From Genset ')
                                MixedConsoChart.toggleSeries('From Genset ')
                                MixedConsoChart.toggleSeries('From Solar ')
                                MixedConsoChart.toggleSeries('From Solar ') #}
                                MixedConsoChart.toggleSeries('From Battery ')
                                MixedConsoChart.toggleSeries('From Battery ')
                                
                                updateDonutChart(ContribChart, ['From Grid', 'From Genset', 'From Solar', 'From Battery'], Object.values(result['pieChart']))
                            }
                        },
                        error: function (result) {
                            // console.log("Error");
                            // console.log(result);
                            swal('Oups...', "Une erreur s'est produite !", 'error'
                            // footer: '<a href>Why do I have this issue?</a>'
                            );

                            setTimeout(function () {
                                resolve()
                            }, 5000);
                        }
                    });
                })
            },
            allowOutsideClick: false
        }]);
    }

    setTimeout(function(){
        var drp_ = $('#gendaterange').data('daterangepicker');
        console.log('drp = ' + drp.startDate.format('YYYY-MM-DD'));
        var startDate_ = drp.startDate.format('YYYY-MM-DD');
        var endDate_ = drp.endDate.format('YYYY-MM-DD');

        $data = JSON.stringify({
        //"selectedDate": $dat, // tabGridId,
        "startDate": startDate_ + ' 00:00:00', // tabGridId,
        "endDate": endDate_ + '23:59:59', // tabFuelId,
        });

        // Danger

        swal.queue([{
            title: 'Chargement...',
            confirmButtonText: 'Confirmez',
            text: 'Veuillez patienter svp !',
            //showCancelButton: true,
            showLoaderOnConfirm: true,
            //confirmButtonClass: 'btn btn-primary',
            //cancelButtonClass: 'btn btn-danger ml-2',
        
            //title: 'The graphs will be updated for the date range :',
            //confirmButtonText: 'Confirm',
            //text: 'From ' + startDate_ + ' To ' + endDate_,
            //showCancelButton: true,
            //showLoaderOnConfirm: true,
            //confirmButtonClass: 'btn btn-primary',
            //cancelButtonClass: 'btn btn-danger ml-2',
            preConfirm: function () {
                return new Promise(function (resolve) { 
                    
                    $.ajax({
                        type: "POST", // method type
                        contentType: "application/json; charset=utf-8",
                        url: _url, // /Target function that will be return result
                        data: $data, // parameter pass data is parameter name param is value
                        dataType: "json",
                        timeout: 120000, // 64241
                        success: function (result) {
                            // $('.fa-sync').removeClass('fa-spin');
                            console.log(result);
                            
                            swal({
                                type: 'success', 
                                title: 'Les graphes ont été mis !',
                                // html: 'Submitted email: ' + email
                            });

                            setTimeout(function () {
                                resolve()
                            }, 1500);

                            if( Object.keys(result).length > 0 ){
                                $('#total-conso').text(parseFloat(result['totalkWh']).toFixed(2))
                                console.log(Object.values(result['Mixed_Conso']))
                                
                                {# MixedConsoChart.destroy()
                                MixedConsoChart = new ApexCharts(
                                    document.querySelector("#conso"),
                                    MixedConsoChart_options
                                );
                                MixedConsoChart.render() #}
                                displayNewData(MixedConsoChart, result['Mixed_Conso']['date'], Object.values(result['Mixed_Conso']['conso']), [startDate, endDate], 4, 'day');
                                {# MixedConsoChart.toggleSeries('From Grid ')
                                MixedConsoChart.toggleSeries('From Grid ')
                                MixedConsoChart.toggleSeries('From Genset ')
                                MixedConsoChart.toggleSeries('From Genset ')
                                MixedConsoChart.toggleSeries('From Solar ')
                                MixedConsoChart.toggleSeries('From Solar ') #}
                                MixedConsoChart.toggleSeries('From Battery ')
                                MixedConsoChart.toggleSeries('From Battery ')
                                
                                updateDonutChart(ContribChart, ['From Grid', 'From Genset', 'From Solar', 'From Battery'], Object.values(result['pieChart']))
                            }
                        },
                        error: function (result) {
                            // console.log("Error");
                            // console.log(result);
                            swal('Oups...', "Une erreur s'est produite !", 'error'
                            // footer: '<a href>Why do I have this issue?</a>'
                            );

                            setTimeout(function () {
                                resolve()
                            }, 5000);
                        }
                    });
                })
            },
            allowOutsideClick: false
        }]); 

        $(".swal2-confirm").click();

    }, 200)

</script> 
{% endblock %}


{# 

<div class="row">
    <div class="col" style="
        padding: 0;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
    ">
        <div class="row layout-top-spacing " style="
            margin: 0;
        ">
        
            <div class="widget widget-one_hybrid widget-grid-site" style="z-index: 2;">
                <div class="widget-heading">
                    <div class="w-icon">
                        <!--?xml version="1.0" encoding="UTF-8"?--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M8.28,5.45L6.5,4.55L7.76,2H16.23L17.5,4.55L15.72,5.44L15,4H9L8.28,5.45M18.62,8H14.09L13.3,5H10.7L9.91,8H5.38L4.1,10.55L5.89,11.44L6.62,10H17.38L18.1,11.45L19.89,10.56L18.62,8M17.77,22H15.7L15.46,21.1L12,15.9L8.53,21.1L8.3,22H6.23L9.12,11H11.19L10.83,12.35L12,14.1L13.16,12.35L12.81,11H14.88L17.77,22M11.4,15L10.5,13.65L9.32,18.13L11.4,15M14.68,18.12L13.5,13.64L12.6,15L14.68,18.12Z"></path></svg>
                    </div>
                    <div class="source-name">GRID</div>
                    <p class="w-value text-center"><span id="grid-kW">10.00</span> kW  
                                                        </p></div>
                <div class="widget-content">    
                    <div class="w-chart" style="position: relative;">
                        <div id="w-load-chart-grid" style="min-height: 30px;"><div id="apexchartsojjp0h7v" class="apexcharts-canvas apexchartsojjp0h7v light" style="width: 312px; height: 30px;"><svg id="SvgjsSvg251769" width="312" height="30" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" class="apexcharts-svg" xmlns:data="ApexChartsNS" transform="translate(0, 0)" style="background: transparent;"><g id="SvgjsG251771" class="apexcharts-inner apexcharts-graphical" transform="translate(0, 0)"><defs id="SvgjsDefs251770"><clipPath id="gridRectMaskojjp0h7v"><rect id="SvgjsRect251791" width="314" height="32" x="-1" y="-1" rx="0" ry="0" fill="#ffffff" opacity="1" stroke-width="0" stroke="none" stroke-dasharray="0"></rect></clipPath><clipPath id="gridRectMarkerMaskojjp0h7v"><rect id="SvgjsRect251792" width="314" height="32" x="-1" y="-1" rx="0" ry="0" fill="#ffffff" opacity="1" stroke-width="0" stroke="none" stroke-dasharray="0"></rect></clipPath><linearGradient id="SvgjsLinearGradient251798" x1="0" y1="0" x2="0" y2="1"><stop id="SvgjsStop251799" stop-opacity="0.4" stop-color="rgba(83,226,27,0.4)" offset="0.45"></stop><stop id="SvgjsStop251800" stop-opacity="0.05" stop-color="rgba(255,255,255,0.05)" offset="1"></stop><stop id="SvgjsStop251801" stop-opacity="0.05" stop-color="rgba(255,255,255,0.05)" offset="1"></stop></linearGradient></defs><line id="SvgjsLine251775" x1="0" y1="0" x2="0" y2="30" stroke="#b6b6b6" stroke-dasharray="3" class="apexcharts-xcrosshairs" x="0" y="0" width="1" height="30" fill="#b1b9c4" filter="none" fill-opacity="0.9" stroke-width="1"></line><g id="SvgjsG251804" class="apexcharts-xaxis" transform="translate(0, 0)"><g id="SvgjsG251805" class="apexcharts-xaxis-texts-g" transform="translate(0, -4)"></g><g id="SvgjsG251806" class="apexcharts-xaxis-title"><text id="SvgjsText251807" font-family="Helvetica, Arial, sans-serif" x="156" y="59.888000000000005" text-anchor="middle" dominant-baseline="auto" font-size="14px" fill="#444444" class="apexcharts-xaxis-title-text " style="font-family: Helvetica, Arial, sans-serif;">Feb 2022</text></g></g><g id="SvgjsG251810" class="apexcharts-grid"><line id="SvgjsLine251812" x1="0" y1="30" x2="312" y2="30" stroke="transparent" stroke-dasharray="0"></line><line id="SvgjsLine251811" x1="0" y1="1" x2="0" y2="30" stroke="transparent" stroke-dasharray="0"></line></g><g id="SvgjsG251794" class="apexcharts-area-series apexcharts-plot-series"><g id="SvgjsG251795" class="apexcharts-series" seriesName="ÉnergiexActive" data:longestSeries="true" rel="1" data:realIndex="0"><path id="apexcharts-area-0" d="M 0 30L 0 21.715428243580927C 8.399999999999999 21.715428243580927 15.600000000000001 1.0340680115990963 24 1.0340680115990963C 32.4 1.0340680115990963 39.6 1.075542713758896 48 1.075542713758896C 56.4 1.075542713758896 63.6 1.077616448866884 72 1.077616448866884C 80.4 1.077616448866884 87.6 1.0485841573550232 96 1.0485841573550232C 104.4 1.0485841573550232 111.6 1.3015798405297794 120 1.3015798405297794C 128.4 1.3015798405297794 135.6 1.1481234425385338 144 1.1481234425385338C 152.4 1.1481234425385338 159.6 1.2165567011021956 168 1.2165567011021956C 176.4 1.2165567011021956 183.6 1.1522709127545099 192 1.1522709127545099C 200.4 1.1522709127545099 207.6 1.3679393639854496 216 1.3679393639854496C 224.4 1.3679393639854496 231.6 1.3160959862857062 240 1.3160959862857062C 248.4 1.3160959862857062 255.6 15.75343980811038 264 15.75343980811038C 272.4 15.75343980811038 279.6 9.834999809907622 288 9.834999809907622C 296.4 9.834999809907622 303.6 8.957809859227954 312 8.957809859227954C 312 8.957809859227954 312 8.957809859227954 312 30M 312 8.957809859227954z" fill="url(#SvgjsLinearGradient251798)" fill-opacity="1" stroke-opacity="1" stroke-linecap="butt" stroke-width="0" stroke-dasharray="0" class="apexcharts-area" index="0" clip-path="url(#gridRectMaskojjp0h7v)" pathTo="M 0 30L 0 21.715428243580927C 8.399999999999999 21.715428243580927 15.600000000000001 1.0340680115990963 24 1.0340680115990963C 32.4 1.0340680115990963 39.6 1.075542713758896 48 1.075542713758896C 56.4 1.075542713758896 63.6 1.077616448866884 72 1.077616448866884C 80.4 1.077616448866884 87.6 1.0485841573550232 96 1.0485841573550232C 104.4 1.0485841573550232 111.6 1.3015798405297794 120 1.3015798405297794C 128.4 1.3015798405297794 135.6 1.1481234425385338 144 1.1481234425385338C 152.4 1.1481234425385338 159.6 1.2165567011021956 168 1.2165567011021956C 176.4 1.2165567011021956 183.6 1.1522709127545099 192 1.1522709127545099C 200.4 1.1522709127545099 207.6 1.3679393639854496 216 1.3679393639854496C 224.4 1.3679393639854496 231.6 1.3160959862857062 240 1.3160959862857062C 248.4 1.3160959862857062 255.6 15.75343980811038 264 15.75343980811038C 272.4 15.75343980811038 279.6 9.834999809907622 288 9.834999809907622C 296.4 9.834999809907622 303.6 8.957809859227954 312 8.957809859227954C 312 8.957809859227954 312 8.957809859227954 312 30M 312 8.957809859227954z" pathFrom="M 0 30L 0 21.715428243580927C 8.399999999999999 21.715428243580927 15.600000000000001 1.0340680115990963 24 1.0340680115990963C 32.4 1.0340680115990963 39.6 1.075542713758896 48 1.075542713758896C 56.4 1.075542713758896 63.6 1.077616448866884 72 1.077616448866884C 80.4 1.077616448866884 87.6 1.0485841573550232 96 1.0485841573550232C 104.4 1.0485841573550232 111.6 1.3015798405297794 120 1.3015798405297794C 128.4 1.3015798405297794 135.6 1.1481234425385338 144 1.1481234425385338C 152.4 1.1481234425385338 159.6 1.2165567011021956 168 1.2165567011021956C 176.4 1.2165567011021956 183.6 1.1522709127545099 192 1.1522709127545099C 200.4 1.1522709127545099 207.6 1.3679393639854496 216 1.3679393639854496C 224.4 1.3679393639854496 231.6 1.3160959862857062 240 1.3160959862857062C 248.4 1.3160959862857062 255.6 15.75343980811038 264 15.75343980811038C 272.4 15.75343980811038 279.6 9.834999809907622 288 9.834999809907622C 296.4 9.834999809907622 303.6 8.957809859227954 312 8.957809859227954C 312 8.957809859227954 312 8.957809859227954 312 30M 312 8.957809859227954z"></path><path id="apexcharts-area-0" d="M 0 21.715428243580927C 8.399999999999999 21.715428243580927 15.600000000000001 1.0340680115990963 24 1.0340680115990963C 32.4 1.0340680115990963 39.6 1.075542713758896 48 1.075542713758896C 56.4 1.075542713758896 63.6 1.077616448866884 72 1.077616448866884C 80.4 1.077616448866884 87.6 1.0485841573550232 96 1.0485841573550232C 104.4 1.0485841573550232 111.6 1.3015798405297794 120 1.3015798405297794C 128.4 1.3015798405297794 135.6 1.1481234425385338 144 1.1481234425385338C 152.4 1.1481234425385338 159.6 1.2165567011021956 168 1.2165567011021956C 176.4 1.2165567011021956 183.6 1.1522709127545099 192 1.1522709127545099C 200.4 1.1522709127545099 207.6 1.3679393639854496 216 1.3679393639854496C 224.4 1.3679393639854496 231.6 1.3160959862857062 240 1.3160959862857062C 248.4 1.3160959862857062 255.6 15.75343980811038 264 15.75343980811038C 272.4 15.75343980811038 279.6 9.834999809907622 288 9.834999809907622C 296.4 9.834999809907622 303.6 8.957809859227954 312 8.957809859227954" fill="none" fill-opacity="1" stroke="#53e21b" stroke-opacity="1" stroke-linecap="butt" stroke-width="2" stroke-dasharray="0" class="apexcharts-area" index="0" clip-path="url(#gridRectMaskojjp0h7v)" pathTo="M 0 21.715428243580927C 8.399999999999999 21.715428243580927 15.600000000000001 1.0340680115990963 24 1.0340680115990963C 32.4 1.0340680115990963 39.6 1.075542713758896 48 1.075542713758896C 56.4 1.075542713758896 63.6 1.077616448866884 72 1.077616448866884C 80.4 1.077616448866884 87.6 1.0485841573550232 96 1.0485841573550232C 104.4 1.0485841573550232 111.6 1.3015798405297794 120 1.3015798405297794C 128.4 1.3015798405297794 135.6 1.1481234425385338 144 1.1481234425385338C 152.4 1.1481234425385338 159.6 1.2165567011021956 168 1.2165567011021956C 176.4 1.2165567011021956 183.6 1.1522709127545099 192 1.1522709127545099C 200.4 1.1522709127545099 207.6 1.3679393639854496 216 1.3679393639854496C 224.4 1.3679393639854496 231.6 1.3160959862857062 240 1.3160959862857062C 248.4 1.3160959862857062 255.6 15.75343980811038 264 15.75343980811038C 272.4 15.75343980811038 279.6 9.834999809907622 288 9.834999809907622C 296.4 9.834999809907622 303.6 8.957809859227954 312 8.957809859227954" pathFrom="M 0 21.715428243580927C 8.399999999999999 21.715428243580927 15.600000000000001 1.0340680115990963 24 1.0340680115990963C 32.4 1.0340680115990963 39.6 1.075542713758896 48 1.075542713758896C 56.4 1.075542713758896 63.6 1.077616448866884 72 1.077616448866884C 80.4 1.077616448866884 87.6 1.0485841573550232 96 1.0485841573550232C 104.4 1.0485841573550232 111.6 1.3015798405297794 120 1.3015798405297794C 128.4 1.3015798405297794 135.6 1.1481234425385338 144 1.1481234425385338C 152.4 1.1481234425385338 159.6 1.2165567011021956 168 1.2165567011021956C 176.4 1.2165567011021956 183.6 1.1522709127545099 192 1.1522709127545099C 200.4 1.1522709127545099 207.6 1.3679393639854496 216 1.3679393639854496C 224.4 1.3679393639854496 231.6 1.3160959862857062 240 1.3160959862857062C 248.4 1.3160959862857062 255.6 15.75343980811038 264 15.75343980811038C 272.4 15.75343980811038 279.6 9.834999809907622 288 9.834999809907622C 296.4 9.834999809907622 303.6 8.957809859227954 312 8.957809859227954"></path><g id="SvgjsG251796" class="apexcharts-series-markers-wrap"><g class="apexcharts-series-markers"><circle id="SvgjsCircle251818" r="0" cx="0" cy="0" class="apexcharts-marker wv0xeraeui no-pointer-events" stroke="#ffffff" fill="#53e21b" fill-opacity="1" stroke-width="2" stroke-opacity="0.9" default-marker-size="0"></circle></g></g><g id="SvgjsG251797" class="apexcharts-datalabels"></g></g></g><line id="SvgjsLine251813" x1="0" y1="0" x2="312" y2="0" stroke="#b6b6b6" stroke-dasharray="0" stroke-width="1" class="apexcharts-ycrosshairs"></line><line id="SvgjsLine251814" x1="0" y1="0" x2="312" y2="0" stroke-dasharray="0" stroke-width="0" class="apexcharts-ycrosshairs-hidden"></line><g id="SvgjsG251815" class="apexcharts-yaxis-annotations"></g><g id="SvgjsG251816" class="apexcharts-xaxis-annotations"></g><g id="SvgjsG251817" class="apexcharts-point-annotations"></g></g><rect id="SvgjsRect251774" width="0" height="0" x="0" y="0" rx="0" ry="0" fill="#fefefe" opacity="1" stroke-width="0" stroke="none" stroke-dasharray="0"></rect><g id="SvgjsG251808" class="apexcharts-yaxis" rel="0" transform="translate(-21, 0)"><g id="SvgjsG251809" class="apexcharts-yaxis-texts-g"></g></g></svg><div class="apexcharts-legend"></div><div class="apexcharts-tooltip dark"><div class="apexcharts-tooltip-title" style="font-family: Helvetica, Arial, sans-serif; font-size: 12px;"></div><div class="apexcharts-tooltip-series-group"><span class="apexcharts-tooltip-marker" style="background-color: rgb(83, 226, 27);"></span><div class="apexcharts-tooltip-text" style="font-family: Helvetica, Arial, sans-serif; font-size: 12px;"><div class="apexcharts-tooltip-y-group"><span class="apexcharts-tooltip-text-label"></span><span class="apexcharts-tooltip-text-value"></span></div><div class="apexcharts-tooltip-z-group"><span class="apexcharts-tooltip-text-z-label"></span><span class="apexcharts-tooltip-text-z-value"></span></div></div></div></div></div></div>
                    <div class="resize-triggers"><div class="expand-trigger"><div style="width: 313px; height: 32px;"></div></div><div class="contract-trigger"></div></div></div>

                    <div class="row ml-2 mt-2" style="font-size:12px">
                        <div class="col">Fourniture</div>
                        <div class="col"><span id="w-grid-fourniture">1697.40</span> kWh</div>
                    </div>
                    <div class="row ml-2" style="font-size:12px">
                        <div class="col">Contribution</div>
                        <div class="col"><span id="w-grid-contrib">99.01</span> %</div>
                    </div>
                    <div class="row ml-2" style="font-size:12px">
                        <div class="col">FP</div>
                        <div class="col"><span id="w-grid-fp">0.92</span></div>
                    </div>
                    <div class="row ml-2 mb-2" style="font-size:12px">
                        <div class="col">Pmax</div>
                        <div class="col"><span id="w-grid-pmax">17.00</span> kW</div>
                    </div>
                </div>
            </div>
            
        </div>
        
        <div class="row layout-top-spacing" style="
            margin-left: 0;
            margin-right: 0;
        ">
            
            <div class="widget widget-one_hybrid widget-genset-site" style="z-index: 2;">
                <div class="widget-heading">
                    <div class="w-icon source-name">
                                                                    <!--?xml version="1.0" encoding="UTF-8"?--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="24" height="24" viewBox="0 0 24 24"><path d="M8,10H16V18H11L9,16H7V11M7,4V6H10V8H7L5,10V13H3V10H1V18H3V15H5V18H8L10,20H18V16H20V19H23V9H20V12H18V8H12V6H15V4H7Z"></path></svg>
                    </div>
                    <div class="source-name"><a href="/installation/datacenter-services-douala-5/genset/6" style="color:#e26b1b">Genset</a></div>
                    <p class="w-value text-center"><span id="genset-kW">0</span> kW                                        
                </p></div>
                <div class="widget-content">    
                    <div class="w-chart" style="position: relative;">
                        <div id="w-load-chart-genset" style="min-height: 30px;"><div id="apexcharts98wtiffp" class="apexcharts-canvas apexcharts98wtiffp light" style="width: 312px; height: 30px;"><svg id="SvgjsSvg251822" width="312" height="30" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" class="apexcharts-svg" xmlns:data="ApexChartsNS" transform="translate(0, 0)" style="background: transparent;"><g id="SvgjsG251824" class="apexcharts-inner apexcharts-graphical" transform="translate(0, 0)"><defs id="SvgjsDefs251823"><clipPath id="gridRectMask98wtiffp"><rect id="SvgjsRect251835" width="314" height="32" x="-1" y="-1" rx="0" ry="0" fill="#ffffff" opacity="1" stroke-width="0" stroke="none" stroke-dasharray="0"></rect></clipPath><clipPath id="gridRectMarkerMask98wtiffp"><rect id="SvgjsRect251836" width="314" height="32" x="-1" y="-1" rx="0" ry="0" fill="#ffffff" opacity="1" stroke-width="0" stroke="none" stroke-dasharray="0"></rect></clipPath><linearGradient id="SvgjsLinearGradient251842" x1="0" y1="0" x2="0" y2="1"><stop id="SvgjsStop251843" stop-opacity="0.4" stop-color="rgba(226,107,27,0.4)" offset="0.45"></stop><stop id="SvgjsStop251844" stop-opacity="0.05" stop-color="rgba(255,255,255,0.05)" offset="1"></stop><stop id="SvgjsStop251845" stop-opacity="0.05" stop-color="rgba(255,255,255,0.05)" offset="1"></stop></linearGradient></defs><line id="SvgjsLine251828" x1="0" y1="0" x2="0" y2="30" stroke="#b6b6b6" stroke-dasharray="3" class="apexcharts-xcrosshairs" x="0" y="0" width="1" height="30" fill="#b1b9c4" filter="none" fill-opacity="0.9" stroke-width="1"></line><g id="SvgjsG251846" class="apexcharts-xaxis" transform="translate(0, 0)"><g id="SvgjsG251847" class="apexcharts-xaxis-texts-g" transform="translate(0, -4)"></g><g id="SvgjsG251848" class="apexcharts-xaxis-title"><text id="SvgjsText251849" font-family="Helvetica, Arial, sans-serif" x="156" y="59.888000000000005" text-anchor="middle" dominant-baseline="auto" font-size="14px" fill="#444444" class="apexcharts-xaxis-title-text " style="font-family: Helvetica, Arial, sans-serif;">Feb 2022</text></g></g><g id="SvgjsG251852" class="apexcharts-grid"><line id="SvgjsLine251854" x1="0" y1="30" x2="312" y2="30" stroke="transparent" stroke-dasharray="0"></line><line id="SvgjsLine251853" x1="0" y1="1" x2="0" y2="30" stroke="transparent" stroke-dasharray="0"></line></g><g id="SvgjsG251838" class="apexcharts-area-series apexcharts-plot-series"><g id="SvgjsG251839" class="apexcharts-series" seriesName="ÉnergiexActive" data:longestSeries="true" rel="1" data:realIndex="0"><g id="SvgjsG251840" class="apexcharts-series-markers-wrap"><g class="apexcharts-series-markers"><circle id="SvgjsCircle251860" r="0" cx="0" cy="0" class="apexcharts-marker whpuaxt4qk no-pointer-events" stroke="#ffffff" fill="#e26b1b" fill-opacity="1" stroke-width="2" stroke-opacity="0.9" default-marker-size="0"></circle></g></g><g id="SvgjsG251841" class="apexcharts-datalabels"></g></g></g><line id="SvgjsLine251855" x1="0" y1="0" x2="312" y2="0" stroke="#b6b6b6" stroke-dasharray="0" stroke-width="1" class="apexcharts-ycrosshairs"></line><line id="SvgjsLine251856" x1="0" y1="0" x2="312" y2="0" stroke-dasharray="0" stroke-width="0" class="apexcharts-ycrosshairs-hidden"></line><g id="SvgjsG251857" class="apexcharts-yaxis-annotations"></g><g id="SvgjsG251858" class="apexcharts-xaxis-annotations"></g><g id="SvgjsG251859" class="apexcharts-point-annotations"></g></g><rect id="SvgjsRect251827" width="0" height="0" x="0" y="0" rx="0" ry="0" fill="#fefefe" opacity="1" stroke-width="0" stroke="none" stroke-dasharray="0"></rect><g id="SvgjsG251850" class="apexcharts-yaxis" rel="0" transform="translate(-21, 0)"><g id="SvgjsG251851" class="apexcharts-yaxis-texts-g"></g></g></svg><div class="apexcharts-legend"></div><div class="apexcharts-tooltip dark"><div class="apexcharts-tooltip-title" style="font-family: Helvetica, Arial, sans-serif; font-size: 12px;"></div><div class="apexcharts-tooltip-series-group"><span class="apexcharts-tooltip-marker" style="background-color: rgb(226, 107, 27);"></span><div class="apexcharts-tooltip-text" style="font-family: Helvetica, Arial, sans-serif; font-size: 12px;"><div class="apexcharts-tooltip-y-group"><span class="apexcharts-tooltip-text-label"></span><span class="apexcharts-tooltip-text-value"></span></div><div class="apexcharts-tooltip-z-group"><span class="apexcharts-tooltip-text-z-label"></span><span class="apexcharts-tooltip-text-z-value"></span></div></div></div></div></div></div>
                    <div class="resize-triggers"><div class="expand-trigger"><div style="width: 313px; height: 32px;"></div></div><div class="contract-trigger"></div></div></div>

                    <div class="row ml-2 mt-2" style="font-size:12px">
                        <div class="col">Fourniture</div>
                        <div class="col"><span id="w-genset-fourniture">17.00</span> kWh</div>
                    </div>
                    <div class="row ml-2" style="font-size:12px">
                        <div class="col">Contribution</div>
                        <div class="col"><span id="w-genset-contrib">0.99</span> %</div>
                    </div>
                    <div class="row ml-2" style="font-size:12px">
                        <div class="col">Conso Fuel : </div>
                        <div class="col"><span id="w-genset-conso-fuel">35.00</span> L</div>
                    </div>
                    <div class="row ml-2 mb-2" style="font-size:12px">
                        <div class="col">Charge Max</div>
                        <div class="col"><span id="w-genset-load-max">22.60</span> %</div>
                    </div>
                </div>
            </div>
            
        </div>
    </div>

    <div class="col mb-5" style="
        padding: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
    ">
        <canvas id="canvas" style="/* position:absolute; *//* top: 0px; */width: 100%;/* left:213px */margin-top: 87px;" height="519" width="436"></canvas><div class="widget widget-one_hybrid widget-load-site" style="z-index: 2;position: static;">
            <div class="widget-heading">
                <div class="w-icon source-name">
                    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="plug" class="svg-inline--fa fa-plug fa-w-12" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M320,32a32,32,0,0,0-64,0v96h64Zm48,128H16A16,16,0,0,0,0,176v32a16,16,0,0,0,16,16H32v32A160.07,160.07,0,0,0,160,412.8V512h64V412.8A160.07,160.07,0,0,0,352,256V224h16a16,16,0,0,0,16-16V176A16,16,0,0,0,368,160ZM128,32a32,32,0,0,0-64,0v96h64Z"></path></svg>
                </div>
                <div class="source-name">Charge</div>
                <p class="w-value text-center"><span id="load-kW">10.00</span> kW
            </p></div>
            <div class="widget-content">    
                <div class="w-chart" style="position: relative;">
                    <div id="w-load-chart" style="min-height: 30px;"><div id="apexchartszhfe80eh" class="apexcharts-canvas apexchartszhfe80eh light" style="width: 228px; height: 30px;"><svg id="SvgjsSvg252127" width="228" height="30" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" class="apexcharts-svg" xmlns:data="ApexChartsNS" transform="translate(0, 0)" style="background: transparent;"><g id="SvgjsG252129" class="apexcharts-inner apexcharts-graphical" transform="translate(0, 0)"><defs id="SvgjsDefs252128"><clipPath id="gridRectMaskzhfe80eh"><rect id="SvgjsRect252164" width="230" height="32" x="-1" y="-1" rx="0" ry="0" fill="#ffffff" opacity="1" stroke-width="0" stroke="none" stroke-dasharray="0"></rect></clipPath><clipPath id="gridRectMarkerMaskzhfe80eh"><rect id="SvgjsRect252165" width="230" height="32" x="-1" y="-1" rx="0" ry="0" fill="#ffffff" opacity="1" stroke-width="0" stroke="none" stroke-dasharray="0"></rect></clipPath><linearGradient id="SvgjsLinearGradient252171" x1="0" y1="0" x2="0" y2="1"><stop id="SvgjsStop252172" stop-opacity="0.4" stop-color="rgba(112,48,160,0.4)" offset="0.45"></stop><stop id="SvgjsStop252173" stop-opacity="0.05" stop-color="rgba(255,255,255,0.05)" offset="1"></stop><stop id="SvgjsStop252174" stop-opacity="0.05" stop-color="rgba(255,255,255,0.05)" offset="1"></stop></linearGradient></defs><line id="SvgjsLine252134" x1="0" y1="0" x2="0" y2="30" stroke="#b6b6b6" stroke-dasharray="3" class="apexcharts-xcrosshairs" x="0" y="0" width="1" height="30" fill="#b1b9c4" filter="none" fill-opacity="0.9" stroke-width="1"></line><g id="SvgjsG252177" class="apexcharts-xaxis" transform="translate(0, 0)"><g id="SvgjsG252178" class="apexcharts-xaxis-texts-g" transform="translate(0, 5.111000000000001)"></g><g id="SvgjsG252179" class="apexcharts-xaxis-title"><text id="SvgjsText252180" font-family="Helvetica, Arial, sans-serif" x="114" y="59.888000000000005" text-anchor="middle" dominant-baseline="auto" font-size="14px" fill="#444444" class="apexcharts-xaxis-title-text " style="font-family: Helvetica, Arial, sans-serif;">14 February</text></g></g><g id="SvgjsG252183" class="apexcharts-grid"><line id="SvgjsLine252185" x1="0" y1="30" x2="228" y2="30" stroke="transparent" stroke-dasharray="0"></line><line id="SvgjsLine252184" x1="0" y1="1" x2="0" y2="30" stroke="transparent" stroke-dasharray="0"></line></g><g id="SvgjsG252167" class="apexcharts-area-series apexcharts-plot-series"><g id="SvgjsG252168" class="apexcharts-series" seriesName="ÉnergiexActive" data:longestSeries="true" rel="1" data:realIndex="0"><path id="apexcharts-area-0" d="M 0 30L 0 1.2509797388637445C 2.9555555555555553 1.2509797388637445 5.488888888888889 20.448672607457212 8.444444444444445 20.448672607457212C 11.4 20.448672607457212 13.933333333333334 12.92919389680721 16.88888888888889 12.92919389680721C 19.844444444444445 12.92919389680721 22.37777777777778 22.041379800037685 25.333333333333336 22.041379800037685C 28.28888888888889 22.041379800037685 30.822222222222223 23.97900969224593 33.77777777777778 23.97900969224593C 36.733333333333334 23.97900969224593 39.266666666666666 25.229252066668668 42.22222222222222 25.229252066668668C 45.17777777777778 25.229252066668668 47.711111111111116 23.5152893882333 50.66666666666667 23.5152893882333C 53.62222222222223 23.5152893882333 56.15555555555556 25.827336557709692 59.111111111111114 25.827336557709692C 62.06666666666667 25.827336557709692 64.60000000000001 25.41441247074438 67.55555555555556 25.41441247074438C 70.5111111111111 25.41441247074438 73.04444444444445 25.429979053387918 76 25.429979053387918C 78.95555555555555 25.429979053387918 81.4888888888889 24.03636025988 84.44444444444444 24.03636025988C 87.39999999999999 24.03636025988 89.93333333333334 26.270574516138723 92.88888888888889 26.270574516138723C 95.84444444444445 26.270574516138723 98.37777777777778 24.903173124977812 101.33333333333334 24.903173124977812C 104.28888888888889 24.903173124977812 106.82222222222224 25.033440842889483 109.77777777777779 25.033440842889483C 112.73333333333333 25.033440842889483 115.26666666666668 21.799688122151245 118.22222222222223 21.799688122151245C 121.17777777777778 21.799688122151245 123.71111111111112 21.709565801583423 126.66666666666667 21.709565801583423C 129.62222222222223 21.709565801583423 132.15555555555557 21.835737050378377 135.11111111111111 21.835737050378377C 138.06666666666666 21.835737050378377 140.60000000000002 20.77229366767804 143.55555555555557 20.77229366767804C 146.51111111111112 20.77229366767804 149.04444444444445 19.744079919381484 152 19.744079919381484C 154.95555555555555 19.744079919381484 157.4888888888889 20.67479770270012 160.44444444444446 20.67479770270012C 163.4 20.67479770270012 165.93333333333334 20.525686226851533 168.88888888888889 20.525686226851533C 171.84444444444443 20.525686226851533 174.3777777777778 22.053669207387845 177.33333333333334 22.053669207387845C 180.2888888888889 22.053669207387845 182.82222222222222 23.134317760378405 185.77777777777777 23.134317760378405C 188.73333333333332 23.134317760378405 191.26666666666668 21.94879959799983 194.22222222222223 21.94879959799983C 197.17777777777778 21.94879959799983 199.71111111111114 22.032367567980906 202.66666666666669 22.032367567980906C 205.62222222222223 22.032367567980906 208.15555555555557 22.693537683419404 211.11111111111111 22.693537683419404C 214.06666666666666 22.693537683419404 216.60000000000002 15.814746742624306 219.55555555555557 15.814746742624306C 222.51111111111112 15.814746742624306 225.04444444444445 3.2713583072297183 228 3.2713583072297183C 228 3.2713583072297183 228 3.2713583072297183 228 30M 228 3.2713583072297183z" fill="url(#SvgjsLinearGradient252171)" fill-opacity="1" stroke-opacity="1" stroke-linecap="butt" stroke-width="0" stroke-dasharray="0" class="apexcharts-area" index="0" clip-path="url(#gridRectMaskzhfe80eh)" pathTo="M 0 30L 0 1.2509797388637445C 2.9555555555555553 1.2509797388637445 5.488888888888889 20.448672607457212 8.444444444444445 20.448672607457212C 11.4 20.448672607457212 13.933333333333334 12.92919389680721 16.88888888888889 12.92919389680721C 19.844444444444445 12.92919389680721 22.37777777777778 22.041379800037685 25.333333333333336 22.041379800037685C 28.28888888888889 22.041379800037685 30.822222222222223 23.97900969224593 33.77777777777778 23.97900969224593C 36.733333333333334 23.97900969224593 39.266666666666666 25.229252066668668 42.22222222222222 25.229252066668668C 45.17777777777778 25.229252066668668 47.711111111111116 23.5152893882333 50.66666666666667 23.5152893882333C 53.62222222222223 23.5152893882333 56.15555555555556 25.827336557709692 59.111111111111114 25.827336557709692C 62.06666666666667 25.827336557709692 64.60000000000001 25.41441247074438 67.55555555555556 25.41441247074438C 70.5111111111111 25.41441247074438 73.04444444444445 25.429979053387918 76 25.429979053387918C 78.95555555555555 25.429979053387918 81.4888888888889 24.03636025988 84.44444444444444 24.03636025988C 87.39999999999999 24.03636025988 89.93333333333334 26.270574516138723 92.88888888888889 26.270574516138723C 95.84444444444445 26.270574516138723 98.37777777777778 24.903173124977812 101.33333333333334 24.903173124977812C 104.28888888888889 24.903173124977812 106.82222222222224 25.033440842889483 109.77777777777779 25.033440842889483C 112.73333333333333 25.033440842889483 115.26666666666668 21.799688122151245 118.22222222222223 21.799688122151245C 121.17777777777778 21.799688122151245 123.71111111111112 21.709565801583423 126.66666666666667 21.709565801583423C 129.62222222222223 21.709565801583423 132.15555555555557 21.835737050378377 135.11111111111111 21.835737050378377C 138.06666666666666 21.835737050378377 140.60000000000002 20.77229366767804 143.55555555555557 20.77229366767804C 146.51111111111112 20.77229366767804 149.04444444444445 19.744079919381484 152 19.744079919381484C 154.95555555555555 19.744079919381484 157.4888888888889 20.67479770270012 160.44444444444446 20.67479770270012C 163.4 20.67479770270012 165.93333333333334 20.525686226851533 168.88888888888889 20.525686226851533C 171.84444444444443 20.525686226851533 174.3777777777778 22.053669207387845 177.33333333333334 22.053669207387845C 180.2888888888889 22.053669207387845 182.82222222222222 23.134317760378405 185.77777777777777 23.134317760378405C 188.73333333333332 23.134317760378405 191.26666666666668 21.94879959799983 194.22222222222223 21.94879959799983C 197.17777777777778 21.94879959799983 199.71111111111114 22.032367567980906 202.66666666666669 22.032367567980906C 205.62222222222223 22.032367567980906 208.15555555555557 22.693537683419404 211.11111111111111 22.693537683419404C 214.06666666666666 22.693537683419404 216.60000000000002 15.814746742624306 219.55555555555557 15.814746742624306C 222.51111111111112 15.814746742624306 225.04444444444445 3.2713583072297183 228 3.2713583072297183C 228 3.2713583072297183 228 3.2713583072297183 228 30M 228 3.2713583072297183z" pathFrom="M -1 30L -1 30L 8.444444444444445 30L 16.88888888888889 30L 25.333333333333336 30L 33.77777777777778 30L 42.22222222222222 30L 50.66666666666667 30L 59.111111111111114 30L 67.55555555555556 30L 76 30L 84.44444444444444 30L 92.88888888888889 30L 101.33333333333334 30L 109.77777777777779 30L 118.22222222222223 30L 126.66666666666667 30L 135.11111111111111 30L 143.55555555555557 30L 152 30L 160.44444444444446 30L 168.88888888888889 30L 177.33333333333334 30L 185.77777777777777 30L 194.22222222222223 30L 202.66666666666669 30L 211.11111111111111 30L 219.55555555555557 30L 228 30"></path><path id="apexcharts-area-0" d="M 0 1.2509797388637445C 2.9555555555555553 1.2509797388637445 5.488888888888889 20.448672607457212 8.444444444444445 20.448672607457212C 11.4 20.448672607457212 13.933333333333334 12.92919389680721 16.88888888888889 12.92919389680721C 19.844444444444445 12.92919389680721 22.37777777777778 22.041379800037685 25.333333333333336 22.041379800037685C 28.28888888888889 22.041379800037685 30.822222222222223 23.97900969224593 33.77777777777778 23.97900969224593C 36.733333333333334 23.97900969224593 39.266666666666666 25.229252066668668 42.22222222222222 25.229252066668668C 45.17777777777778 25.229252066668668 47.711111111111116 23.5152893882333 50.66666666666667 23.5152893882333C 53.62222222222223 23.5152893882333 56.15555555555556 25.827336557709692 59.111111111111114 25.827336557709692C 62.06666666666667 25.827336557709692 64.60000000000001 25.41441247074438 67.55555555555556 25.41441247074438C 70.5111111111111 25.41441247074438 73.04444444444445 25.429979053387918 76 25.429979053387918C 78.95555555555555 25.429979053387918 81.4888888888889 24.03636025988 84.44444444444444 24.03636025988C 87.39999999999999 24.03636025988 89.93333333333334 26.270574516138723 92.88888888888889 26.270574516138723C 95.84444444444445 26.270574516138723 98.37777777777778 24.903173124977812 101.33333333333334 24.903173124977812C 104.28888888888889 24.903173124977812 106.82222222222224 25.033440842889483 109.77777777777779 25.033440842889483C 112.73333333333333 25.033440842889483 115.26666666666668 21.799688122151245 118.22222222222223 21.799688122151245C 121.17777777777778 21.799688122151245 123.71111111111112 21.709565801583423 126.66666666666667 21.709565801583423C 129.62222222222223 21.709565801583423 132.15555555555557 21.835737050378377 135.11111111111111 21.835737050378377C 138.06666666666666 21.835737050378377 140.60000000000002 20.77229366767804 143.55555555555557 20.77229366767804C 146.51111111111112 20.77229366767804 149.04444444444445 19.744079919381484 152 19.744079919381484C 154.95555555555555 19.744079919381484 157.4888888888889 20.67479770270012 160.44444444444446 20.67479770270012C 163.4 20.67479770270012 165.93333333333334 20.525686226851533 168.88888888888889 20.525686226851533C 171.84444444444443 20.525686226851533 174.3777777777778 22.053669207387845 177.33333333333334 22.053669207387845C 180.2888888888889 22.053669207387845 182.82222222222222 23.134317760378405 185.77777777777777 23.134317760378405C 188.73333333333332 23.134317760378405 191.26666666666668 21.94879959799983 194.22222222222223 21.94879959799983C 197.17777777777778 21.94879959799983 199.71111111111114 22.032367567980906 202.66666666666669 22.032367567980906C 205.62222222222223 22.032367567980906 208.15555555555557 22.693537683419404 211.11111111111111 22.693537683419404C 214.06666666666666 22.693537683419404 216.60000000000002 15.814746742624306 219.55555555555557 15.814746742624306C 222.51111111111112 15.814746742624306 225.04444444444445 3.2713583072297183 228 3.2713583072297183" fill="none" fill-opacity="1" stroke="#7030a0" stroke-opacity="1" stroke-linecap="butt" stroke-width="2" stroke-dasharray="0" class="apexcharts-area" index="0" clip-path="url(#gridRectMaskzhfe80eh)" pathTo="M 0 1.2509797388637445C 2.9555555555555553 1.2509797388637445 5.488888888888889 20.448672607457212 8.444444444444445 20.448672607457212C 11.4 20.448672607457212 13.933333333333334 12.92919389680721 16.88888888888889 12.92919389680721C 19.844444444444445 12.92919389680721 22.37777777777778 22.041379800037685 25.333333333333336 22.041379800037685C 28.28888888888889 22.041379800037685 30.822222222222223 23.97900969224593 33.77777777777778 23.97900969224593C 36.733333333333334 23.97900969224593 39.266666666666666 25.229252066668668 42.22222222222222 25.229252066668668C 45.17777777777778 25.229252066668668 47.711111111111116 23.5152893882333 50.66666666666667 23.5152893882333C 53.62222222222223 23.5152893882333 56.15555555555556 25.827336557709692 59.111111111111114 25.827336557709692C 62.06666666666667 25.827336557709692 64.60000000000001 25.41441247074438 67.55555555555556 25.41441247074438C 70.5111111111111 25.41441247074438 73.04444444444445 25.429979053387918 76 25.429979053387918C 78.95555555555555 25.429979053387918 81.4888888888889 24.03636025988 84.44444444444444 24.03636025988C 87.39999999999999 24.03636025988 89.93333333333334 26.270574516138723 92.88888888888889 26.270574516138723C 95.84444444444445 26.270574516138723 98.37777777777778 24.903173124977812 101.33333333333334 24.903173124977812C 104.28888888888889 24.903173124977812 106.82222222222224 25.033440842889483 109.77777777777779 25.033440842889483C 112.73333333333333 25.033440842889483 115.26666666666668 21.799688122151245 118.22222222222223 21.799688122151245C 121.17777777777778 21.799688122151245 123.71111111111112 21.709565801583423 126.66666666666667 21.709565801583423C 129.62222222222223 21.709565801583423 132.15555555555557 21.835737050378377 135.11111111111111 21.835737050378377C 138.06666666666666 21.835737050378377 140.60000000000002 20.77229366767804 143.55555555555557 20.77229366767804C 146.51111111111112 20.77229366767804 149.04444444444445 19.744079919381484 152 19.744079919381484C 154.95555555555555 19.744079919381484 157.4888888888889 20.67479770270012 160.44444444444446 20.67479770270012C 163.4 20.67479770270012 165.93333333333334 20.525686226851533 168.88888888888889 20.525686226851533C 171.84444444444443 20.525686226851533 174.3777777777778 22.053669207387845 177.33333333333334 22.053669207387845C 180.2888888888889 22.053669207387845 182.82222222222222 23.134317760378405 185.77777777777777 23.134317760378405C 188.73333333333332 23.134317760378405 191.26666666666668 21.94879959799983 194.22222222222223 21.94879959799983C 197.17777777777778 21.94879959799983 199.71111111111114 22.032367567980906 202.66666666666669 22.032367567980906C 205.62222222222223 22.032367567980906 208.15555555555557 22.693537683419404 211.11111111111111 22.693537683419404C 214.06666666666666 22.693537683419404 216.60000000000002 15.814746742624306 219.55555555555557 15.814746742624306C 222.51111111111112 15.814746742624306 225.04444444444445 3.2713583072297183 228 3.2713583072297183" pathFrom="M -1 30L -1 30L 8.444444444444445 30L 16.88888888888889 30L 25.333333333333336 30L 33.77777777777778 30L 42.22222222222222 30L 50.66666666666667 30L 59.111111111111114 30L 67.55555555555556 30L 76 30L 84.44444444444444 30L 92.88888888888889 30L 101.33333333333334 30L 109.77777777777779 30L 118.22222222222223 30L 126.66666666666667 30L 135.11111111111111 30L 143.55555555555557 30L 152 30L 160.44444444444446 30L 168.88888888888889 30L 177.33333333333334 30L 185.77777777777777 30L 194.22222222222223 30L 202.66666666666669 30L 211.11111111111111 30L 219.55555555555557 30L 228 30"></path><g id="SvgjsG252169" class="apexcharts-series-markers-wrap"><g class="apexcharts-series-markers"><circle id="SvgjsCircle252191" r="0" cx="0" cy="0" class="apexcharts-marker wt5huwtcc no-pointer-events" stroke="#ffffff" fill="#7030a0" fill-opacity="1" stroke-width="2" stroke-opacity="0.9" default-marker-size="0"></circle></g></g><g id="SvgjsG252170" class="apexcharts-datalabels"></g></g></g><line id="SvgjsLine252186" x1="0" y1="0" x2="228" y2="0" stroke="#b6b6b6" stroke-dasharray="0" stroke-width="1" class="apexcharts-ycrosshairs"></line><line id="SvgjsLine252187" x1="0" y1="0" x2="228" y2="0" stroke-dasharray="0" stroke-width="0" class="apexcharts-ycrosshairs-hidden"></line><g id="SvgjsG252188" class="apexcharts-yaxis-annotations"></g><g id="SvgjsG252189" class="apexcharts-xaxis-annotations"></g><g id="SvgjsG252190" class="apexcharts-point-annotations"></g></g><rect id="SvgjsRect252133" width="0" height="0" x="0" y="0" rx="0" ry="0" fill="#fefefe" opacity="1" stroke-width="0" stroke="none" stroke-dasharray="0"></rect><g id="SvgjsG252181" class="apexcharts-yaxis" rel="0" transform="translate(-21, 0)"><g id="SvgjsG252182" class="apexcharts-yaxis-texts-g"></g></g></svg><div class="apexcharts-legend"></div><div class="apexcharts-tooltip dark"><div class="apexcharts-tooltip-title" style="font-family: Helvetica, Arial, sans-serif; font-size: 12px;"></div><div class="apexcharts-tooltip-series-group"><span class="apexcharts-tooltip-marker" style="background-color: rgb(112, 48, 160);"></span><div class="apexcharts-tooltip-text" style="font-family: Helvetica, Arial, sans-serif; font-size: 12px;"><div class="apexcharts-tooltip-y-group"><span class="apexcharts-tooltip-text-label"></span><span class="apexcharts-tooltip-text-value"></span></div><div class="apexcharts-tooltip-z-group"><span class="apexcharts-tooltip-text-z-label"></span><span class="apexcharts-tooltip-text-z-value"></span></div></div></div></div></div></div>
                <div class="resize-triggers"><div class="expand-trigger"><div style="width: 229px; height: 32px;"></div></div><div class="contract-trigger"></div></div></div>

                <div class="row ml-2 mt-2" style="font-size:12px">
                    <div class="col">Consommation</div>
                    <div class="col"><span id="w-load-conso">3120.72</span> kWh</div>
                </div>
                <div class="row ml-2" style="font-size:12px">
                    <div class="col">FP</div>
                    <div class="col"><span id="w-load-fp">1.00</span></div>
                </div>
                <div class="row ml-2 mb-2" style="font-size:12px">
                    <div class="col">Pmax</div>
                    <div class="col"><span id="w-load-pmax">17.93</span> kW</div>
                </div>
            </div>
        </div>
    </div>

    <div class="col">
        <div class="row layout-top-spacing ">
        
            <div class="widget widget-one_hybrid widget-solar-site" style="z-index: 2;">
                <div class="widget-heading">
                    <div class="w-icon source-name">
                        <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="solar-panel" class="svg-inline--fa fa-solar-panel fa-w-20" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path fill="currentColor" d="M431.98 448.01l-47.97.05V416h-128v32.21l-47.98.05c-8.82.01-15.97 7.16-15.98 15.99l-.05 31.73c-.01 8.85 7.17 16.03 16.02 16.02l223.96-.26c8.82-.01 15.97-7.16 15.98-15.98l.04-31.73c.01-8.85-7.17-16.03-16.02-16.02zM585.2 26.74C582.58 11.31 568.99 0 553.06 0H86.93C71 0 57.41 11.31 54.79 26.74-3.32 369.16.04 348.08.03 352c-.03 17.32 14.29 32 32.6 32h574.74c18.23 0 32.51-14.56 32.59-31.79.02-4.08 3.35 16.95-54.76-325.47zM259.83 64h120.33l9.77 96H250.06l9.77-96zm-75.17 256H71.09L90.1 208h105.97l-11.41 112zm16.29-160H98.24l16.29-96h96.19l-9.77 96zm32.82 160l11.4-112h149.65l11.4 112H233.77zm195.5-256h96.19l16.29 96H439.04l-9.77-96zm26.06 256l-11.4-112H549.9l19.01 112H455.33z"></path></svg>
                    </div>
                    <div class="source-name">Solaire</div>
                    <p class="w-value text-center"><span id="solar-kW">-</span> 
                </p></div>
                <div class="widget-content">    
                    <div class="w-chart" style="position: relative;">
                        <div id="w-load-chart-solar" style="min-height: 30px;"><div id="apexcharts56pn288o" class="apexcharts-canvas apexcharts56pn288o light" style="width: 228px; height: 30px;"><svg id="SvgjsSvg251863" width="228" height="30" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" class="apexcharts-svg" xmlns:data="ApexChartsNS" transform="translate(0, 0)" style="background: transparent;"><g id="SvgjsG251865" class="apexcharts-inner apexcharts-graphical" transform="translate(0, 17)"><defs id="SvgjsDefs251864"><clipPath id="gridRectMask56pn288o"><rect id="SvgjsRect251901" width="230" height="15" x="-1" y="-1" rx="0" ry="0" fill="#ffffff" opacity="1" stroke-width="0" stroke="none" stroke-dasharray="0"></rect></clipPath><clipPath id="gridRectMarkerMask56pn288o"><rect id="SvgjsRect251902" width="230" height="15" x="-1" y="-1" rx="0" ry="0" fill="#ffffff" opacity="1" stroke-width="0" stroke="none" stroke-dasharray="0"></rect></clipPath><linearGradient id="SvgjsLinearGradient251908" x1="0" y1="0" x2="0" y2="1"><stop id="SvgjsStop251909" stop-opacity="0.4" stop-color="rgba(255,199,25,0.4)" offset="0.45"></stop><stop id="SvgjsStop251910" stop-opacity="0.05" stop-color="rgba(255,255,255,0.05)" offset="1"></stop><stop id="SvgjsStop251911" stop-opacity="0.05" stop-color="rgba(255,255,255,0.05)" offset="1"></stop></linearGradient></defs><line id="SvgjsLine251871" x1="0" y1="0" x2="0" y2="13" stroke="#b6b6b6" stroke-dasharray="3" class="apexcharts-xcrosshairs" x="0" y="0" width="1" height="13" fill="#b1b9c4" filter="none" fill-opacity="0.9" stroke-width="1"></line><g id="SvgjsG251912" class="apexcharts-xaxis" transform="translate(0, 0)"><g id="SvgjsG251913" class="apexcharts-xaxis-texts-g" transform="translate(0, 5.111000000000001)"></g><g id="SvgjsG251914" class="apexcharts-xaxis-title"><text id="SvgjsText251915" font-family="Helvetica, Arial, sans-serif" x="114" y="42.888000000000005" text-anchor="middle" dominant-baseline="auto" font-size="14px" fill="#444444" class="apexcharts-xaxis-title-text " style="font-family: Helvetica, Arial, sans-serif;">Feb 2022</text></g></g><g id="SvgjsG251918" class="apexcharts-grid"><line id="SvgjsLine251920" x1="0" y1="13" x2="228" y2="13" stroke="transparent" stroke-dasharray="0"></line><line id="SvgjsLine251919" x1="0" y1="1" x2="0" y2="13" stroke="transparent" stroke-dasharray="0"></line></g><g id="SvgjsG251904" class="apexcharts-area-series apexcharts-plot-series"><g id="SvgjsG251905" class="apexcharts-series" seriesName="ÉnergiexActive" data:longestSeries="true" rel="1" data:realIndex="0"><g id="SvgjsG251906" class="apexcharts-series-markers-wrap"></g><g id="SvgjsG251907" class="apexcharts-datalabels"></g></g></g><line id="SvgjsLine251921" x1="0" y1="0" x2="228" y2="0" stroke="#b6b6b6" stroke-dasharray="0" stroke-width="1" class="apexcharts-ycrosshairs"></line><line id="SvgjsLine251922" x1="0" y1="0" x2="228" y2="0" stroke-dasharray="0" stroke-width="0" class="apexcharts-ycrosshairs-hidden"></line><g id="SvgjsG251923" class="apexcharts-yaxis-annotations"></g><g id="SvgjsG251924" class="apexcharts-xaxis-annotations"></g><g id="SvgjsG251925" class="apexcharts-point-annotations"></g></g><text id="SvgjsText251866" font-family="Nunito, sans-serif" x="114" y="27" text-anchor="middle" dominant-baseline="auto" font-size="10px" fill="#373d3f" class="apexcharts-title-text" style="font-family: Nunito, sans-serif; opacity: 1;">Data not yet available</text><rect id="SvgjsRect251870" width="0" height="0" x="0" y="0" rx="0" ry="0" fill="#fefefe" opacity="1" stroke-width="0" stroke="none" stroke-dasharray="0"></rect><g id="SvgjsG251916" class="apexcharts-yaxis" rel="0" transform="translate(-21, 0)"><g id="SvgjsG251917" class="apexcharts-yaxis-texts-g"></g></g></svg><div class="apexcharts-legend"></div></div></div>
                    <div class="resize-triggers"><div class="expand-trigger"><div style="width: 229px; height: 32px;"></div></div><div class="contract-trigger"></div></div></div>

                    <div class="row ml-2 mt-2" style="font-size:12px">
                        <div class="col">Fourniture</div>
                                                                    <div class="col">-</div>
                    </div>
                    <div class="row ml-2" style="font-size:12px">
                        <div class="col">Contribution</div>
                                                                    <div class="col">-</div>
                    </div>
                    <div class="row ml-2" style="font-size:12px">
                        <div class="col">F. charge</div>
                                                                    <div class="col">-</div>
                    </div>
                    <div class="row ml-2 mb-2" style="font-size:12px">
                        <div class="col">Pmax</div>
                                                                    <div class="col">-</div>
                    </div>
                </div>
            </div>
            
        </div>
        
        <div class="row layout-top-spacing">
            
            <div class="widget widget-one_hybrid widget-followers" style="width:230px;background-color:#fff;z-index: 2;">
                <div class="widget-heading">
                    <div class="w-icon source-name">
                        <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="car-battery" class="svg-inline--fa fa-car-battery fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M480 128h-32V80c0-8.84-7.16-16-16-16h-96c-8.84 0-16 7.16-16 16v48H192V80c0-8.84-7.16-16-16-16H80c-8.84 0-16 7.16-16 16v48H32c-17.67 0-32 14.33-32 32v256c0 17.67 14.33 32 32 32h448c17.67 0 32-14.33 32-32V160c0-17.67-14.33-32-32-32zM192 264c0 4.42-3.58 8-8 8H72c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h112c4.42 0 8 3.58 8 8v16zm256 0c0 4.42-3.58 8-8 8h-40v40c0 4.42-3.58 8-8 8h-16c-4.42 0-8-3.58-8-8v-40h-40c-4.42 0-8-3.58-8-8v-16c0-4.42 3.58-8 8-8h40v-40c0-4.42 3.58-8 8-8h16c4.42 0 8 3.58 8 8v40h40c4.42 0 8 3.58 8 8v16z"></path></svg>
                    </div>
                    <div class="source-name">Battery</div>
                    <p class="w-value text-center"><span id="batt-kW">-</span>   
                    
                </p></div>
                <div class="widget-content">    
                    <div class="w-chart" style="position: relative;">
                        <div id="w-load-chart-batt" style="min-height: 30px;"><div id="apexchartsx0cs2btr" class="apexcharts-canvas apexchartsx0cs2btr light" style="width: 228px; height: 30px;"><svg id="SvgjsSvg251928" width="228" height="30" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs" class="apexcharts-svg" xmlns:data="ApexChartsNS" transform="translate(0, 0)" style="background: transparent;"><g id="SvgjsG251930" class="apexcharts-inner apexcharts-graphical" transform="translate(0, 17)"><defs id="SvgjsDefs251929"><clipPath id="gridRectMaskx0cs2btr"><rect id="SvgjsRect251966" width="230" height="15" x="-1" y="-1" rx="0" ry="0" fill="#ffffff" opacity="1" stroke-width="0" stroke="none" stroke-dasharray="0"></rect></clipPath><clipPath id="gridRectMarkerMaskx0cs2btr"><rect id="SvgjsRect251967" width="230" height="15" x="-1" y="-1" rx="0" ry="0" fill="#ffffff" opacity="1" stroke-width="0" stroke="none" stroke-dasharray="0"></rect></clipPath><linearGradient id="SvgjsLinearGradient251973" x1="0" y1="0" x2="0" y2="1"><stop id="SvgjsStop251974" stop-opacity="0.4" stop-color="rgba(27,85,226,0.4)" offset="0.45"></stop><stop id="SvgjsStop251975" stop-opacity="0.05" stop-color="rgba(255,255,255,0.05)" offset="1"></stop><stop id="SvgjsStop251976" stop-opacity="0.05" stop-color="rgba(255,255,255,0.05)" offset="1"></stop></linearGradient></defs><line id="SvgjsLine251936" x1="0" y1="0" x2="0" y2="13" stroke="#b6b6b6" stroke-dasharray="3" class="apexcharts-xcrosshairs" x="0" y="0" width="1" height="13" fill="#b1b9c4" filter="none" fill-opacity="0.9" stroke-width="1"></line><g id="SvgjsG251977" class="apexcharts-xaxis" transform="translate(0, 0)"><g id="SvgjsG251978" class="apexcharts-xaxis-texts-g" transform="translate(0, 5.111000000000001)"></g><g id="SvgjsG251979" class="apexcharts-xaxis-title"><text id="SvgjsText251980" font-family="Helvetica, Arial, sans-serif" x="114" y="42.888000000000005" text-anchor="middle" dominant-baseline="auto" font-size="14px" fill="#444444" class="apexcharts-xaxis-title-text " style="font-family: Helvetica, Arial, sans-serif;">Feb 2022</text></g></g><g id="SvgjsG251983" class="apexcharts-grid"><line id="SvgjsLine251985" x1="0" y1="13" x2="228" y2="13" stroke="transparent" stroke-dasharray="0"></line><line id="SvgjsLine251984" x1="0" y1="1" x2="0" y2="13" stroke="transparent" stroke-dasharray="0"></line></g><g id="SvgjsG251969" class="apexcharts-area-series apexcharts-plot-series"><g id="SvgjsG251970" class="apexcharts-series" seriesName="ÉnergiexActive" data:longestSeries="true" rel="1" data:realIndex="0"><g id="SvgjsG251971" class="apexcharts-series-markers-wrap"></g><g id="SvgjsG251972" class="apexcharts-datalabels"></g></g></g><line id="SvgjsLine251986" x1="0" y1="0" x2="228" y2="0" stroke="#b6b6b6" stroke-dasharray="0" stroke-width="1" class="apexcharts-ycrosshairs"></line><line id="SvgjsLine251987" x1="0" y1="0" x2="228" y2="0" stroke-dasharray="0" stroke-width="0" class="apexcharts-ycrosshairs-hidden"></line><g id="SvgjsG251988" class="apexcharts-yaxis-annotations"></g><g id="SvgjsG251989" class="apexcharts-xaxis-annotations"></g><g id="SvgjsG251990" class="apexcharts-point-annotations"></g></g><text id="SvgjsText251931" font-family="Nunito, sans-serif" x="114" y="27" text-anchor="middle" dominant-baseline="auto" font-size="10px" fill="#373d3f" class="apexcharts-title-text" style="font-family: Nunito, sans-serif; opacity: 1;">Data not yet available</text><rect id="SvgjsRect251935" width="0" height="0" x="0" y="0" rx="0" ry="0" fill="#fefefe" opacity="1" stroke-width="0" stroke="none" stroke-dasharray="0"></rect><g id="SvgjsG251981" class="apexcharts-yaxis" rel="0" transform="translate(-21, 0)"><g id="SvgjsG251982" class="apexcharts-yaxis-texts-g"></g></g></svg><div class="apexcharts-legend"></div></div></div>
                    <div class="resize-triggers"><div class="expand-trigger"><div style="width: 229px; height: 32px;"></div></div><div class="contract-trigger"></div></div></div>

                    <div class="row ml-2 mt-2" style="font-size:12px">
                        <div class="col">Fourniture</div>
                                                                    <div class="col">-</div>
                    </div>
                    <div class="row ml-2" style="font-size:12px">
                        <div class="col">Contribution</div>
                                                                    <div class="col">-</div>
                    </div>
                    <div class="row ml-2" style="font-size:12px">
                        <div class="col">Niv Charge : </div>
                                                                    <div class="col">-</div>
                    </div>
                    <div class="row ml-2 mb-2" style="font-size:12px">
                        <div class="col">Autonomie</div>
                                                                    <div class="col">-</div>
                    </div>
                </div>
            </div>
            
        </div>
    </div>
</div>

 #}